---
title: Monitor Windows Virtual Desktop cost pricing estimates - Azure
description: How to troubleshoot issues with Azure Monitor for Windows Virtual Desktop.
author: Heidilohr
ms.topic: conceptual
ms.date: 03/29/2021
ms.author: helohr
manager: lizross
---

# Estimating Azure Monitor costs

This article provides pricing estimates for Azure Monitor for Windows Virtual Desktop to help you understand the following:

- How to estimate data ingestion and storage costs upfront before you enable this feature

- How to measure data ingestion and storage costs after you enable this feature

- How to control the ingestion and storage of data to reduce costs

Azure Monitor Logs collects, indexes, and stores data generated by your environment.

The Azure Monitor pricing model is primarily based on the amount of data ingested in gigabytes per day into your Log Analytics workspace. The cost of a Log Analytics workspace isn't based only on the volume of data collected, it is also dependent on the plan selected, and how long you choose to store data generated from your environment.

*! All sizes and pricing are for sample estimation only. Please refer to the Azure Monitor* [pricing](https://azure.microsoft.com/pricing/details/monitor/) *page for the most recent pricing based on your Azure Monitor Log Analytics pricing model and Azure region.*

## Estimating data ingestion and storage costs

Azure Monitor for Windows Virtual Desktop recommends a predefined set of data written as logs in your Log Analytics workspace. In the following estimates, we will only look at Billable data in the default configuration

Azure Monitor for Windows Virtual Desktop default data configuration includes:

- Specified performance counters

- Windows event logs

- Windows Virtual Desktop Diagnostics

Estimations are for one Virtual Machine with the following components and usage:

- 2 vCPU (4 cores), 2 disks

- 20 sessions per day (i.e. 20 users)

- Avg. Session duration = 4 hours (240 minutes)

- 200 processes per session

## Estimating performance counter costs

Performance counters show the performance of system resources. Performance counter data ingestion depends on your environment size and usage. In most cases, performance counters should make up 80 to 99% of your data ingestion for Azure Monitor for Windows Virtual Desktop.

Before diving into the estimation, it’s important that you understand that each performance counter sends data at a specific frequency. We set a default sample rate per minute (you can edit this rate), but that rate will be applied at different multiplying factors depending on the counter. All of the recommended performance counters for our monitoring tools will send at our set default sample rate per minute per one of the following factors:

- **Per Virtual Machine (VM):** These counters send data at the default sample rate per Virtual Machine in your environment. The number of records these counters will send per day equals the default sample rate per minute \* 60 minutes per hour \* avg. active hours for a VM per day \* \# of VMs in your environment.

- **Per CPU:** These counters send data at the default sample rate for each CPU core in each VM in your environment. The number of records these counters will send per day equals the default sample rate per minute\* number of CPU cores in the VM SKU \* 60 minutes per hour \* avg. active hours per VM

- **Per disk:** These counters send data at the default sample rate for each disk in each VM in your environment. The number of records these counters will send per day equals the default sample rate per minute\* number of disks in the VM SKU \* 60 minutes per hour \* avg. active hours for a VM

- **Per session/per user:** These counters send data at the default sample rate per session (typically one session per user) in your environment. The number of records these counters will send per day equals the default sample rate per minute \* avg. sessions per day \* avg. session duration.

- **Per process:** These counters send data most frequently, at the default rate for each process in each session in your environment. The number of records these counters will send per day equals the default sample rate per minute \* avg. sessions per day \* avg. session duration.

The following list details the 20 performance counters Azure Monitor for Windows Virtual Desktop collects by default.

| Counter name | Default sample rate | Frequency factor | Estimated records per day |
|--------------|---------------------|------------------|--------------------------|
| Logical Disk(C:)\\% free space | 60 seconds  | Per disk             | 2,880       |
| Logical Disk(C:)\\Avg. Disk Queue Length   | 30 seconds    | Per disk             | 5,760       |
| Logical Disk(C:)\\Avg. Disk sec/Transfer  | 60 seconds       | Per disk             | 2,880       |
| Logical Disk(C:)\\Current Disk Queue Length  | 30 seconds      | Per disk             | 5,760       |
| Memory(\*)\\Available Mbytes | 30 seconds    | Per VM  | 2,880       |
| Memory(\*)\\Page Faults/sec | 30 seconds   | Per VM  | 2,880       |
| Memory(\*)\\Pages/sec | 30 seconds   | Per VM  | 2,880       |
| Memory(\*)\\% Committed Bytes in Use | 30 seconds    | Per VM  | 2,880       |
| PhysicalDisk(\*)\\Avg. Disk Queue Length | 30 seconds      | Per disk             | 5,760       |
| PhysicalDisk(\*)\\Avg. Disk sec/Read | 30 seconds  | Per disk             | 5,760       |
| PhysicalDisk(\*)\\Avg. Disk sec/Transfer | 30 seconds  | Per disk             | 5,760       |
| PhysicalDisk(\*)\\Avg. Disk sec/Write | 30 seconds | Per disk             | 5,760       |
| Processor Information(_Total)\\% Processor Time | 30 seconds | Per core/CPU         | 11,520      |
| Terminal Services(\*)\\Active Sessions          | 60 seconds | Per VM  | 1,440       |
| Terminal Services(\*)\\Inactive Sessions        | 60 seconds | Per VM  | 1,440       |
| Terminal Services(\*)\\Total Sessions | 60 seconds | Per VM  | 1,440       |
| **†**User Input Delay per Process(\*)\\Max Input Delay         | 30 seconds | Per process          | 480,000     |
| **†**User Input Delay per Session(\*)\\Max Input Delay        | 30 seconds | Per session          | 57,600      |
| RemoteFX Network(\*)\\Current TCP RTT | 30 seconds | Per VM  | 2,880       |
| RemoteFX Network(\*)\\Current UDP Bandwidth     | 30 seconds | Per VM  | 2,880       |
| **TOTAL**   |            |         | **611,040** |
| **If we estimate each record size to be 200 Bytes††, this comes out to roughly 150 Megabytes of Performance counter data per day per VM for the sample environment.**  |            |         |             |

**†** To learn more about input delay performance counters, see [User Input Delay performance counters](/windows-server/remote/remote-desktop-services/rds-rdsh-performance-counters/).

**††** Record size can vary, this is an approximation.

## Windows events

Windows Event logs are data sources collected by Log Analytics agents on Windows virtual machines. You can collect events from standard logs like System and Application as well as custom logs created by applications you need to monitor. We exclude information-level events from the default configuration for cost savings.

| Event name         | Event type    | Estimated records per day |
|----------------|-------------------|--------------------------|
| Application            | Error and Warning | 900\*       |
| Microsoft-Windows-TerminalServices-RemoteConnectionManager/Admin     | Error and Warning | N/A            |
| Microsoft-Windows-TerminalServices-LocalSessionManager/Operational   | Error and Warning | N/A            |
| System    | Error and Warning | N/A            |
| Microsoft-FSLogix-Apps/Operational             | Error and Warning | N/A           |
| Microsoft-FSLogix-Apps/Admin     | Error and Warning | N/A            |

If we estimate each record size to be 1,500 Bytes\*\*, this comes out to roughly 1-2 Megabytes of Event data per day for the specified environment.

The following table lists the default Windows Events for Azure Monitor for Windows Virtual Desktop.

\*Events send whenever the terms of the error or warning are met in the environment. Machines in healthy states will send fewer events than machines in unhealthy states. Since event count is unpredictable, we use a range based on examples from relatively healthy environments for this estimation.

\*\*Record size can vary, this is an approximation.

To learn more about Windows events, see [Windows event records properties](../azure-monitor/agents/data-sources-windows-events.md).

## Diagnostics

The diagnostics service creates activity logs for both user and administrative actions.

| **Windows Virtual Desktop diagnostics**  | **Est. records per day** | **Est.**  **size per event (Bytes)** | **Size Estimate per day**  **(Megabytes)** |
|----------------------|--------------------------|--------------------------------------|--------------------------------------------|
| WVDCheckpoints       | \~500-1000\*             | 200\*\*    | 0.1-0.2 |
| WVDConnections       |             |   |         |
| WVDErrors            |             |   |         |
| WVDFeeds             |             |   |         |
| WVDManagement        |             |   |         |
| **TOTAL**            | **\< 1 Megabyte**        |   |         |

To learn more about the activity log categories, see [Windows Virtual Desktop diagnostics](diagnostics-log-analytics.md).

## Estimated total costs

| **Data source**        | **Size Estimate per day (Megabytes)**   |
|-------------------------------------|------------------------------------------|
| Performance counters   | 150 |
| Events    | 1-5 |
| Windows Virtual Desktop diagnostics | \< 1 |
| **TOTAL**              | **Total = 150-155 Megabytes per VM per dayà \~3-6 Gigabytes/VM/month (one month = 31 days) for the specified environment** |

Using the default, Pay-as-you-go model for [Log Analytics pricing](https://azure.microsoft.com/pricing/details/monitor/), you can estimate the Azure Monitor data collection and storage cost per month. Depending on your data ingestion, you may also consider the Capacity Reservation model for Log Analytics pricing.

## Measuring data ingestion

### Understanding volume of data ingestion

Your true monitoring costs will depend on your environment size, usage, and health. To understand how to measure data ingestion in your Log analytics workspace, see [Understanding ingested log data volume](../azure-monitor/logs/manage-cost-storage.md#understanding-ingested-data-volume).

**Performance counters** from the session hosts are likely to be your largest source of ingested data for Azure Monitor for Windows Virtual Desktop.

You can run the following custom query on your Log Analytics workspace to understand frequency and MB ingested per Performance counter over the last day:

>   let WVDHosts = dynamic(['Host1.MyCompany.com', 'Host2.MyCompany.com']);

>   Perf

>   \| where TimeGenerated \> ago(1d)

>   \| where Computer in (WVDHosts)

>   \| extend PerfCounter = strcat(ObjectName, ":", CounterName)

>   \| summarize Records = count(TimeGenerated), InstanceNames =
>   dcount(InstanceName), Bytes=sum(_BilledSize) by PerfCounter

>   \| extend Billed_MBytes = Bytes / (1024 \* 1024), BytesPerRecord = Bytes /
>   Records

>   \| sort by Records desc

This query will show ALL performance counters you have enabled on the environment, not just the default ones for Azure Monitor for Windows Virtual Desktop. This information can help you understand how to target management to reduce costs, like reducing a counter’s frequency or removing it altogether.

## Manage your data ingestion to reduce costs

To learn about managing rights and permissions to the workbook, review [Access control](../azure-monitor/visualize/workbooks-access-control.md).

*! Removing data points will impact dependent visuals in Azure Monitor for Windows Virtual Desktop.*

Log Analytics settings

Optimize your **Log Analytics** settings to manage data ingestion:

- Use a designated Log Analytics workspace for your Windows Virtual Desktop resources to ensure that performance counters and events are only collected only for the virtual machines in your Windows Virtual Desktop deployment.

- Adjust your Log Analytics storage settings to manage costs. You can reduce the retention period, evaluate whether a fixed storage pricing tier would be more cost-effective, or set boundaries on how much data you can ingest to limit impact of an unhealthy deployment. See [manage usage and costs with Azure Monitor Logs] ([Manage usage and costs for Azure Monitor Logs - Azure Monitor \| Microsoft Docs](https://docs.microsoft.com/en-us/azure/azure-monitor/platform/manage-cost-storage#:~:text=%20Manage%20usage%20and%20costs%20with%20Azure%20Monitor,usage%20is%20higher%20than%20expected.%20%20More)).

## Remove excess data

Our default configuration is the only set of data we recommend for Azure Monitor for Windows Virtual Desktop. You always have the option to add additional data points and view them in the Host Diagnostics: Host browser or build custom charts for them, however added data will increase your Log Analytics cost. These can be removed for cost savings.

## Performance counters

To remove Performance counters or reduce their frequency see [Configuring Performance counters](../azure-monitor/platform/data-sources-performance-counters.md#configuring-performance-counters). The document details how to add counters, but they can be removed and edited in the same location.

## Events

Events are unlikely to cause a spike in data ingestion when all hosts are healthy. An unhealthy host can increase events sent, but the information can be critical to understanding the problem. We recommend keeping all recommended Error and Warning level events. To manage Windows Events, see [Configuring Windows Event logs](../azure-monitor/agents/data-sources-windows-events.md#configuring-windows-event-logs).

## Diagnostics

Windows Virtual Desktop diagnostics should make up less than 1% of your data storage costs. We recommend keeping these. To manage Windows Virtual Desktop diagnostics, [Use Log Analytics for the diagnostics feature](diagnostics-log-analytics.md).

## Next steps

- [Use Azure Monitor for Windows Virtual Desktop to monitor your deployment](azure-monitor.md).

- Use the [glossary](azure-monitor-glossary.md) to learn more about terms and concepts.

- If you encounter a problem, check out our [troubleshooting guide](troubleshoot-azure-monitor.md) for help.

- Check out [Monitoring usage and estimated costs in Azure Monitor - Azure Monitor \| Microsoft Docs](../azure-monitor/usage-estimated-costs.md) to learn more about managing your monitoring costs.
