---
title: Monitor Windows Virtual Desktop cost pricing estimates - Azure
description: How to estimate costs and pricing for using Azure Monitor for Windows Virtual Desktop.
author: Heidilohr
ms.topic: conceptual
ms.date: 03/29/2021
ms.author: helohr
manager: lizross
---

# Estimate Azure Monitor costs

Azure Monitor Logs is a service that collects, indexes, and stores data generated by your environment. Because of this, the Azure Monitor pricing model is based on the amount of data that's brought into and processed (or "ingested") by your Log Analytics workspace in gigabytes per day. The cost of a Log Analytics workspace isn't only based on the volume of data collected, but also which Azure payment plan you've selected and how long you choose to store the data your environment generates.

This article will explain the following things to help you understand how pricing in Azure Monitor works:

- How to estimate data ingestion and storage costs upfront before you enable this feature
- How to measure data ingestion and storage costs after you enable this feature
- How to control the ingestion and storage of data to reduce costs

>[!NOTE]
> All sizes and pricing listed in this article are just examples to demonstrate how estimation works. For a more accurate assessment based on your Azure Monitor Log Analytics pricing model and Azure region, see [Azure Monitor pricing](https://azure.microsoft.com/pricing/details/monitor/).

## Estimate data ingestion and storage costs

We recommend you use a predefined set of data written as logs in your Log Analytics workspace. In the following example estimates, we'll look at billable data in the default configuration

Azure Monitor for Windows Virtual Desktop default data configuration includes the following features:

- Specified performance counters
- Windows event logs
- Windows Virtual Desktop Diagnostics

The specs for the virtual machine (VM) we'll be using in this example include the following components and usage:

- 2 vCPUs (4 cores), 2 disks
- 20 sessions per day (assuming one session per user, this means about 20 users)
- An average session duration of 4 hours (240 minutes)
- 200 processes per session

## Estimating performance counter costs

Performance counters show how the system resources are performing. Performance counter data ingestion depends on your environment size and usage. In most cases, performance counters should make up 80 to 99% of your data ingestion for Azure Monitor for Windows Virtual Desktop.

Before you start estimating, itâ€™s important that you understand that each performance counter sends data at a specific frequency. We set a default sample rate-per-minute (you can also edit this rate in your settings), but that rate will be applied at different multiplying factors depending on the counter. The following factors affect the rate:

- For the per virtual machine (VM) factor, each counter sends data at the default sample rate per VM in your environment. The number of records these counters will send per day equals the default sample rate per minute, divided by 60 minutes per hour, divided by average active hours for a VM per day, divided by the number of VMs in your environment.

- For the per CPU factor, each counter sends data at the default sample rate for each CPU core in each VM in your environment. The number of records these counters will send per day equals the default sample rate per minute divided by the number of CPU cores in the VM SKU, divided by 60 minutes per hour, divided by the average active hours per VM.

- For the per disk factor, each counter sends data at the default sample rate for each disk in each VM in your environment. The number of records these counters will send per day equals the default sample rate per minute divided by number of disks in the VM SKU, divided by 60 minutes per hour, divided by the average active hours for a VM.

- For the per session/per user factor, each counter sends data at the default sample rate per session (typically one session per user) in your environment. The number of records these counters will send per day equals the default sample rate per minute divided by the average number of sessions per day, divided by the average session duration.

- For the per-process factor, each counter sends data most frequently and at the default rate for each process in each session in your environment. The number of records these counters will send per day equals the default sample rate per minute divided by the average number of sessions per day, divided by the average session duration.

The following table lists the 20 performance counters Azure Monitor for Windows Virtual Desktop collects by default:

| Counter name | Default sample rate | Frequency factor | Estimated records per day |
|--------------|---------------------|------------------|--------------------------|
| Logical Disk(C:)\\% free space | 60 seconds  | Per disk             | 2,880       |
| Logical Disk(C:)\\Avg. Disk Queue Length   | 30 seconds    | Per disk             | 5,760       |
| Logical Disk(C:)\\Avg. Disk sec/Transfer  | 60 seconds       | Per disk             | 2,880       |
| Logical Disk(C:)\\Current Disk Queue Length  | 30 seconds      | Per disk             | 5,760       |
| Memory(\*)\\Available Mbytes | 30 seconds    | Per VM  | 2,880       |
| Memory(\*)\\Page Faults/sec | 30 seconds   | Per VM  | 2,880       |
| Memory(\*)\\Pages/sec | 30 seconds   | Per VM  | 2,880       |
| Memory(\*)\\% Committed Bytes in Use | 30 seconds    | Per VM  | 2,880       |
| PhysicalDisk(\*)\\Avg. Disk Queue Length | 30 seconds      | Per disk             | 5,760       |
| PhysicalDisk(\*)\\Avg. Disk sec/Read | 30 seconds  | Per disk             | 5,760       |
| PhysicalDisk(\*)\\Avg. Disk sec/Transfer | 30 seconds  | Per disk             | 5,760       |
| PhysicalDisk(\*)\\Avg. Disk sec/Write | 30 seconds | Per disk             | 5,760       |
| Processor Information(_Total)\\% Processor Time | 30 seconds | Per core/CPU         | 11,520      |
| Terminal Services(\*)\\Active Sessions          | 60 seconds | Per VM  | 1,440       |
| Terminal Services(\*)\\Inactive Sessions        | 60 seconds | Per VM  | 1,440       |
| Terminal Services(\*)\\Total Sessions | 60 seconds | Per VM  | 1,440       |
| User Input Delay per Process(\*)\\Max Input Delay         | 30 seconds | Per process          | 480,000     |
| User Input Delay per Session(\*)\\Max Input Delay        | 30 seconds | Per session          | 57,600      |
| RemoteFX Network(\*)\\Current TCP RTT | 30 seconds | Per VM  | 2,880       |
| RemoteFX Network(\*)\\Current UDP Bandwidth     | 30 seconds | Per VM  | 2,880       |

In this example, the total cost would be $611,040.

If we estimate each record size to be 200 bytes, this comes out to roughly 150 megabytes of performance counter data per day per VM in the example environment. However, record size can vary, so the record size for your deployment may be different.

To learn more about input delay performance counters, see [User Input Delay performance counters](/windows-server/remote/remote-desktop-services/rds-rdsh-performance-counters/).

## Windows Event logs

Windows Event logs are data sources collected by Log Analytics agents on Windows virtual machines. You can collect events from standard logs like System and Application as well as custom logs created by applications you need to monitor. We exclude information-level events from the default configuration for cost savings.

The following table lists the default Windows Events for Azure Monitor for Windows Virtual Desktop:

| Event name         | Event type    | Estimated records per day |
|----------------|-------------------|--------------------------|
| Application            | Error and Warning | 900\*       |
| Microsoft-Windows-TerminalServices-RemoteConnectionManager/Admin     | Error and Warning | N/A            |
| Microsoft-Windows-TerminalServices-LocalSessionManager/Operational   | Error and Warning | N/A            |
| System    | Error and Warning | N/A            |
| Microsoft-FSLogix-Apps/Operational             | Error and Warning | N/A           |
| Microsoft-FSLogix-Apps/Admin     | Error and Warning | N/A            |

If we estimate each record size in this example to be 1,500 bytes, this comes out to roughly 1 to 2 Megabytes of Event data per day for the specified environment.

\* Windows Events sends events whenever the terms of the error or warning are met in the environment. Machines in healthy states will send fewer events than machines in unhealthy states. Since event count is unpredictable, we use a range based on examples from relatively healthy environments for this estimation.

To learn more about Windows events, see [Windows event records properties](../azure-monitor/agents/data-sources-windows-events.md).

## Diagnostics

The diagnostics service creates activity logs for both user and administrative actions.

Here's an example of estimating usage for the diagnostics feature:

| Windows Virtual Desktop diagnostics  | Estimated records per day | Estimated size per event (bytes) | Size Estimate per day (megabytes) |
|----------------------|--------------------------|--------------------------------------|--------------------------------------------|
| WVDCheckpoints       | \~500-1000             | 200    | 0.1-0.2 |
| WVDConnections       |  N/A           | N/A  |  N/A       |
| WVDErrors            |  N/A           | N/A  | N/A        |
| WVDFeeds             |  N/A           | N/A  | N/A        |
| WVDManagement        | N/A            | N/A  | N/A        |

The total for this example is less than 1 MB.

To learn more about the activity log categories, see [Windows Virtual Desktop diagnostics](diagnostics-log-analytics.md).

## Estimated total costs

Finally, let's estimate the total cost based on the values in the previous sections:

| Data source        | Size estimate per day (megabytes)   |
|-------------------------------------|------------------------------------------|
| Performance counters   | 150 |
| Events    | 1-5 |
| Windows Virtual Desktop diagnostics | \< 1 |

The total for this example is 150-155 Megabytes per VM per day divided by ~3-6 Gigabytes/VM/month (one month = 31 days) for the specified environment.

Using the default, Pay-as-you-go model for [Log Analytics pricing](https://azure.microsoft.com/pricing/details/monitor/), you can estimate the Azure Monitor data collection and storage cost per month. Depending on your data ingestion, you may also consider the Capacity Reservation model for Log Analytics pricing.

## Measuring data ingestion

Your true monitoring costs will depend on your environment size, usage, and health. To understand how to measure data ingestion in your Log analytics workspace, see [Understanding ingested log data volume](../azure-monitor/logs/manage-cost-storage.md#understanding-ingested-data-volume).

**Performance counters** from the session hosts are likely to be your largest source of ingested data for Azure Monitor for Windows Virtual Desktop.

You can run the following custom query on your Log Analytics workspace to understand frequency and MB ingested per Performance counter over the last day:

```
let WVDHosts = dynamic(['Host1.MyCompany.com', 'Host2.MyCompany.com']);

Perf

\| where TimeGenerated \> ago(1d)

\| where Computer in (WVDHosts)

\| extend PerfCounter = strcat(ObjectName, ":", CounterName)

\| summarize Records = count(TimeGenerated), InstanceNames = dcount(InstanceName), Bytes=sum(_BilledSize) by PerfCounter

\| extend Billed_MBytes = Bytes / (1024 \* 1024), BytesPerRecord = Bytes / Records

\| sort by Records desc
```

This query will show all performance counters you have enabled on the environment, not just the default ones for Azure Monitor for Windows Virtual Desktop. This information can help you understand which areas to target to reduce costs, like reducing a counterâ€™s frequency or removing it altogether.

## Manage your data ingestion to reduce costs

This section will explain how to change your settings to manage data ingestion and reduce costs.

To learn about managing rights and permissions to the workbook, see [Access control](../azure-monitor/visualize/workbooks-access-control.md).

>[!NOTE]
>Removing data points will impact their corresponding visuals in Azure Monitor for Windows Virtual Desktop.

### Log Analytics settings

Here are some suggestions fro how to optimize your **Log Analytics** settings to manage data ingestion:

- Use a designated Log Analytics workspace for your Windows Virtual Desktop resources to ensure that Log ANalytics only collects performance counters and events for the virtual machines in your Windows Virtual Desktop deployment.
- Adjust your Log Analytics storage settings to manage costs. You can reduce the retention period, evaluate whether a fixed storage pricing tier would be more cost-effective, or set boundaries on how much data you can ingest to limit impact of an unhealthy deployment. To learn more, see [Manage usage and costs for Azure Monitor Logs](../azure-monitor/platform/manage-cost-storage.md).

### Remove excess data

Our default configuration is the only set of data we recommend for Azure Monitor for Windows Virtual Desktop. You always have the option to add additional data points and view them in the Host Diagnostics: Host browser or build custom charts for them, however added data will increase your Log Analytics cost. These can be removed for cost savings.

### Remove performance counters

You can also reduce costs by removing performance counters. To remove Performance counters or reduce their frequency see [Configuring Performance counters](../azure-monitor/platform/data-sources-performance-counters.md#configuring-performance-counters). The document details how to add counters, but they can be removed and edited in the same location.

### Manage Windows Events

Windows Events are unlikely to cause a spike in data ingestion when all hosts are healthy. An unhealthy host can increase events sent, but the information can be critical to fixing the host's issues. We recommend keeping all recommended Error and Warning level events. To manage Windows Events, see [Configuring Windows Event logs](../azure-monitor/agents/data-sources-windows-events.md#configuring-windows-event-logs).

### Manage diagnostics

Windows Virtual Desktop diagnostics should make up less than 1% of your data storage costs, so we don't recommend removing them. To manage Windows Virtual Desktop diagnostics, [Use Log Analytics for the diagnostics feature](diagnostics-log-analytics.md).

## Next steps

Learn more about Azure Monitor for Windows Virtual Desktop at these articles:

- [Use Azure Monitor for Windows Virtual Desktop to monitor your deployment](azure-monitor.md).
- Use the [glossary](azure-monitor-glossary.md) to learn more about terms and concepts.
- If you encounter a problem, check out our [troubleshooting guide](troubleshoot-azure-monitor.md) for help.
- Check out [Monitoring usage and estimated costs in Azure Monitor](../azure-monitor/usage-estimated-costs.md) to learn more about managing your monitoring costs.
