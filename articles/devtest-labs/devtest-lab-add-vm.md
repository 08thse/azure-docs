---
title: Create and add a virtual machine to a lab
description: Learn how to use the Azure portal to add a virtual machine to a lab in Azure DevTest Labs. You can choose a base that is either a custom image or a formula.
ms.topic: how-to
ms.date: 02/24/2022
---

# Create lab virtual machines in Azure DevTest Labs

This article describes how to create Azure virtual machines (VMs) in a lab in Azure DevTest Labs by using the Azure portal.

## Prerequisite

- At least user access to a lab in DevTest Labs.

## Configure basic settings

1. In the [Azure portal](https://portal.azure.com), go to the **Overview** page for your lab.

1. On the lab **Overview** page, select **Add**.

   :::image type="content" source="./media/devtest-lab-add-vm/portal-lab-add-vm.png" alt-text="Lab overview page showing add button.":::

1. On the **Choose a base** page, select an image for the VM. Remaining options might differ depending on image.

1. On the **Basics Settings** tab of the **Create lab resource** screen, provide the following information:

   - **Virtual machine name**: Keep the autogenerated name of your email username plus a three-digit number, or enter another unique VM name.
   - **User Name**: Keep your email username, or enter another user name to grant administrator privileges on the VM.
   - **Use a saved secret**: Select this checkbox to use a secret from Azure Key Vault instead of a password to access the VM. If you select this option, select the secret to use from the **Secret** dropdown list.
   - **Password**: If you don't choose to use a secret, enter a VM password between 8 and 123 characters long.
   - **Save as default password**: Select this checkbox to save the password in the Key Vault associated with the lab.
   - **Virtual machine size**: Keep the default value for the base, or select **Change Size** to select different sizes.
   - **OS disk type**: Keep the default value for the base, or select a different option from the dropdown list.
   - **Artifacts**: This field shows the number of artifacts already configured for this VM base. Optionally, select **Add or Remove Artifacts** to select and configure artifacts to add to the VM.

   :::image type="content" source="./media/devtest-lab-add-vm/portal-lab-vm-basic-settings.png" alt-text="Virtual machine basic settings page.":::

<a name="add-artifacts-during-installation"></a>
## Add optional artifacts

VMs can add artifacts from the [DevTest Labs public artifact repository](https://github.com/Azure/azure-devtestlab/Artifacts) or private artifact repositories. For more information, see [Add artifacts to DevTest Labs VMs](add-artifact-vm.md). To add artifacts during VM creation:

1. On the **Basic Settings** tab of the **Create lab resource** screen, select **Add or Remove Artifacts**.

1. On the **Add artifacts** page, select the arrow next to each artifact you want to add to the VM.

1. On each **Add artifact** pane, enter any required and optional parameter values, and then select **OK**. The artifact appears under **Selected artifacts**, and the number of configured artifacts updates.

   :::image type="content" source="./media/devtest-lab-add-vm/portal-add-artifact-during.png" alt-text="Add artifact to virtual machine.":::

1. When you're done adding artifacts, select **OK**.

## Configure optional advanced settings

Optionally, select the **Advanced Settings** tab on the **Create lab resource** screen, and change any of the following information:

- **Virtual network**: Leave as-is, or select a different network from the dropdown list. For more information, see [Add a virtual network in Azure DevTest Labs](devtest-lab-configure-vnet.md).
- **Subnet**: Leave as-is, or if necessary, select a different subnet from the dropdown list.
- **IP address**: Leave at **Shared**, or select **Public** or **Private**. For more information, see [Understand shared IP addresses in Azure DevTest Labs](devtest-lab-shared-ip.md).
- **Expiration date**: Leave at **Will not expire**, or set an expiration date and time for the VM. For more information, see [Set VM expiration date](devtest-lab-use-resource-manager-template.md#set-vm-expiration-date).
- **Make this machine claimable**: Leave at **No** to keep yourself as the owner of the VM. To make the VM claimable by any lab user after creation, select **Yes**. For more information, see [Create and manage claimable VMs](devtest-lab-add-claimable-vm.md).
- **Number of instances**: To create more than one VM with this configuration, enter a number other than *1*.
- **View ARM Template**: Select to view and save the VM configuration as an Azure Resource Manager (ARM) template. You can use the ARM template to [deploy new VMs with Azure PowerShell](../azure-resource-manager/templates/overview.md).

:::image type="content" source="./media/devtest-lab-add-vm/portal-lab-vm-advanced-settings.png" alt-text="Virtual machine advanced settings page.":::

## Complete the VM deployment

On the **Basic Settings** tab of the **Create lab resource** screen, select **Create**.

During deployment, you can select the **Notifications** icon at the top of the screen to see progress. Creating a VM takes a while.

When the deployment is complete, you can see your VM listed under **My virtual machines** on the lab **Overview** page. Or, if you chose **Make this machine claimable** during VM creation, select **Claimable virtual machines** in the left navigation to see the VM listed on the **Claimable virtual machines** page. Select **Refresh** if your VMs don't appear. 

:::image type="content" source="./media/devtest-lab-add-vm/portal-lab-vm-creation-status.png" alt-text="Lab VM creation status page.":::

## Next steps

- Add artifacts to VMs after creation. See [Add artifacts to DevTest Labs VMs](add-artifact-vm.md#add-artifacts-to-vms-from-the-azure-portal).
- Create DevTest Labs VMs by using [PowerShell](devtest-lab-vm-powershell.md), [Azure CLI](devtest-lab-vmcli.md), an [ARM template](devtest-lab-use-resource-manager-template.md), or from a [shared image gallery](add-vm-use-shared-image.md).
- Learn how to [create custom artifacts](devtest-lab-artifact-author.md) for DevTest Labs VMs.
- Learn how to [create and claim claimable VMs](devtest-lab-add-claimable-vm) in a lab.
- Connect to a lab VM by selecting **Connect** on the VM's **Overview** page. Or [connect to your lab VMs through a browser](connect-virtual-machine-through-browser.md).
- Explore the DevTest Labs public repositories of [artifacts], [environments](https://github.com/Azure/azure-devtestlab/Environments), and [QuickStart ARM templates](https://github.com/Azure/azure-devtestlab/samples/DevTestLabs/QuickStartTemplates).

