---
title: Design your Azure Sentinel workspace architecture | Microsoft Docs
description: Use a decision tree to understand how you might want to design your Azure Sentinel workspace architecture.
services: sentinel
author: batamig
ms.author: bagol
ms.service: azure-sentinel
ms.subservice: azure-sentinel
ms.topic: conceptual
ms.date: 07/13/2021
---

# Design your Azure Sentinel workspace architecture

This article provides a decision tree to help you make key decisions about how to design your Azure Sentinel workspace architecture. For more information, see [Azure Sentinel workspace architecture best practices](workspace-architecture-best-practices.md).

## Prerequisites

Before working through the decision tree, make sure you have the following information:

|Prerequisite  |  |
|---------|---------|
|**Regulatory requirements related to Azure data residency**     |  Azure Sentinel can run on workspaces in most, but not all regions [supported in GA for Log Analytics](https://azure.microsoft.com/global-infrastructure/services/?products=monitor). Newly supported Log Analytics regions may take some time to onboard the Azure Sentinel service. <br><br> Data generated by Azure Sentinel, such as incidents, bookmarks, and analytics rules, may contain some customer data sourced from the customer's Log Analytics workspaces.<br><br> For more information, see [Geographical availability and data residency](quickstart-onboard.md#geographical-availability-and-data-residency).|
|**Data sources**     |   Find out which [data sources](connect-data-sources.md) you need to connect, including built-in connectors to both Microsoft and non-Microsoft solutions. You can also use Common Event Format (CEF), Syslog or REST-API to connect your data sources with Azure Sentinel. <br><br>If you have Azure VMs in multiple Azure locations that you need to collect the logs from and the saving on data egress cost is important to you, you need to calculate the data egress cost using [Bandwidth pricing calculator](https://azure.microsoft.com/en-us/pricing/details/bandwidth/#overview) for each Azure location.      |
|**User roles and data access levels/permissions**     |    Azure Sentinel uses [Azure role-based access control (Azure RBAC)](/azure/role-based-access-control/role-assignments-portal) to provide [built-in roles](/azure/role-based-access-control/built-in-roles) that can be assigned to users, groups, and services in Azure. <br><br>All Azure Sentinel built-in roles grant read access to the data in your Azure Sentinel workspace. Therefore, you need to find out whether there is a need to control data access per data source or row-level as that will impact the workspace design decision. For more information, see [Custom roles and advanced Azure RBAC](roles.md#custom-roles-and-advanced-azure-rbac).     |
|**Daily ingestion rate**     |  The daily ingestion rate,usually in GB/day, is one of the key factors in cost management and planning considerations and workspace design for Azure Sentinel. <br><br>In most cloud and hybrid environments, networking devices, such as firewalls or proxies,and Windows and Linux servers produce the most ingested data. To obtain the most accurate results, Microsoft recommends an exhaustive inventory of data sources. <br><br>Alternatively, the Azure Sentinel [cost calculator](https://cloudpartners.transform.microsoft.com/download?assetname=assets%2FAzure_Sentinel_Calculator.xlsx&download=1) includes tables useful in estimating footprints of data sources. <br><br>**Important**: These estimates are a starting point, and log verbosity settings and workload will produce variances. We recommend that you monitor your system regularly to track any changes. Regular monitoring is recommended based on your scenario. <br><br>For more information, see [Manage usage and costs with Azure Monitor Logs](/azure/azure-monitor/logs/manage-cost-storage).       |
|     |         |

## Decision tree

The following image shows a full decision tree flow chart to help you understand how to best design your workspace.

[ ![Azure Sentinel workspace design decision tree.](media/best-practices/workspace-decision-tree.png) ](media/best-practices/workspace-decision-tree.png#lightbox)

The following sections provide a full-text version of this decision tree.

### Step 1: New or existing workspace?

Are you planning to enable Azure Sentinel on an existing workspace? 

- **If you'll be creating a new workspace**, continue directly with [step 2](#step-2-keeping-data-in-different-azure-geographies).

- **If you'll be using an existing workspace**, and will be consuming more than 100 GB/day of non-SOC data, we do *not* recommend using an existing workspace for Azure Sentinel for the sake of cost efficiency.

    If the amount of non-SOC data you'll be ingesting is less than 100 GB/day, continue evaluating with [step 2](#step-2-keeping-data-in-different-azure-geographies), but consider you selection in step 6 when this question arises again.

### Step 2: Keeping data in different Azure geographies?

Do you have regulatory requirements to keep data in different Azure geographies?

If so, use a separate Azure Sentinel workspace for each Azure region that has compliance requirements.

For more information, see [Region considerations](workspace-architecture-best-practices.md#region-considerations).

### Step 3: Do you have multiple Azure tenants?

- **If you have only a single tenant**, continue directly with step 4.

- **If you have multiple Azure tenants**, consider whether you're collecting logs that are specific to a tenant boundary, such as Office 365 or Microsoft 365 Defender.

    - **If you don't have any tenant-specific logs**, continue directly with step 5.

    - **If you *are* collecting tenant-specific logs**, use a separate Azure Sentinel tenant for each Azure AD tenant.

        <a name="ref1"></a>[Flow chart reference 1](#decision-tree): Logs specific to tenant boundaries, such as from Office 365 and Microsoft Defender, can only be stored in the workspace within the same tenant.

        Although you could use a custom connector to collect tenant-specific logs from a workspace in another tenant, doing so would have the following disadvantages:

        - Data collected by custom connectors will be ingested into custom tables, and therefore can’t leverage all the built-in rules and workbooks.

        - Custom tables are not supported by some of the built-in features, such as UEBA and machine learning rules.

        - Additional cost and effort required for the custom connectors, such as using Azure Functions and Logic Apps.

        If any of these disadvantages are not a concern for your organization, continue with step 4. 

### Step 4: Splitting billing / charge-back?

If you need to split your billing or charge-back, consider whether the usage reporting or manual cross-charge works for you.

- **If usage reporting or manual cross-charge works for you**, continue with step 6

### Decision tree notes


Decision Tree References:
1.	Logs specific to tenant boundaries, such as Office 365 and Microsoft Defender, can only be stored in the workspace within the same tenant.

Although it is possible to collect tenant specific logs from a workspace in another tenant using custom connectors, it is not recommended due to the following disadvantages:

•	Data collected by custom connectors will be ingested into custom tables and therefore can’t leverage all the OOTB rules and Workbooks.
•	Custom tables are not considered by some of the built-in features, such as UEBA and machine learning rules.
•	Additional cost and effort required for the custom connectors (e.g., using Azure Functions and Logic Apps).

If the above points are not a major concern, proceed to step 4 of the decision tree.

2.	Refer to this article for ways to analyze data ingestion and costs.

3.	In general, we recommend that customers have a separate workspace for their non-SOC data so that non-SOC data will not be subject to Azure Sentinel costs.
However, there can be scenarios in which combining both SOC and non-SOC data is cheaper than separating them. Assume we have Security logs ingesting at 50GB per day, Operations logs ingesting at 50GB per day, and a workspace in the East US region:
Use case 1:
SOC team has a workspace with Azure Sentinel enabled and the Ops team has a separate workspace without Azure Sentinel enabled.
SOC team:
•	Azure Sentinel cost for 50GB/day is $6,438.50 per month.
•	First three months of retention are free.
Ops team:
•	Cost of Log Analytics at 50GB/day is around $3,553.50 per month.
•	First 31 days of retention are free.
The total cost for both equals $9,992 per month.

Use case 2:
Both SOC and Ops teams share the same workspace with Azure Sentinel enabled.
By combining both logs, ingestion will be 100GB per day, qualifying for eligibility for Commitment Tier (55% for Sentinel and 15% for LA).
SOC and Ops team:
•	Cost of Azure Sentinel for 100GB/day equals $8,880 per month.

In the above example, there is a cost savings of $1,112 per month by combining both workspaces, and the Ops team will also enjoy 3 months of free retention instead of only 31 days. Note that this is only applicable when each SOC and non-SOC data has an ingestion size of >=50GB/day and <100GB/day.
Note that the above example considers the scenario purely from a cost perspective and, to clearly illustrate potential cost savings, ignores other key design factors that are usually examined to determine whether to use a single or multiple separate workspaces. Kindly go through the remaining steps in the decision tree to determine a complete recommendation.

4.	Data egress refers to the bandwidth cost for moving data out of Azure datacenters.

5.	There are several ways to reduce egress costs. Calculate data egress cost with the Azure pricing calculator to estimate the cost and determine which region(s) you actually need. It is recommended to have as few workspaces as possible. Consider combining workspace(s) with low egress costs. Remember, bandwidth costs are usually only a small portion of the Azure bill compared with Azure Sentinel and Log Analytics ingestion costs.

For example, 1,000 VMs each generating 1GB/day, sending data from US to EU, and accounting for a 2:1 compression ratio in the agent is estimated as follows:
		1000 VMs * (1GB/day ÷ 2) * 30 days/month * $0.05/GB = $750/month bandwidth cost
This is much cheaper when compared with Azure Sentinel + Log Analytics ingestion costs of ~$75,000/month

6.	In order to use the Azure Sentinel portal, a user needs to have at least Azure Sentinel Reader role and the role must have reader permission on all the tables in the workspace. Therefore, it is not possible to segregate data unless access to the Azure Sentinel portal is not required (i.e., a user can still perform log search with Log Analytics).

7.	There are a few options to configure resource-context RBAC for non-Azure resources. The task consists mainly of associating a Resource ID to the data when sending to Azure Sentinel so that the permission can be scoped using resource-context RBAC. 

8.	Resource permissions or resource-context allows users to view logs for resources that they have access to. The workspace access mode must be set to “User resource or workspace permissions” and only tables relevant to the resources you have permission to will be visible when you perform a search in the Logs page.

9.	Table level Azure RBAC allows you to define more granular control to data in a Log Analytics workspace, in addition to the other permissions. This control allows you to define specific data types that are accessible only to a specific set of users. Refer to this blog for a sample use case.

10.	In general, it is not recommended to use the same workspace for both SOC and non-SOC data, so that non-SOC data won’t be subject to Azure Sentinel costs.  However, there can be scenarios in which combining both SOC and non-SOC data is cheaper than separating them. Refer to Reference 3 for a sample use case.
However, this recommendation is made purely from a cost perspective and there are other key design factors that are customarily examined to determine whether to use a single or multiple separate workspaces. Kindly go through the remaining steps in the decision tree to determine a complete recommendation.
In addition, to avoid double ingestion costs, consider collecting overlapped data on a single workspace only with Table level Azure RBAC .
11.	It is not recommended to use the same workspace for non-SOC data because that data will be subject to Azure Sentinel costs. In addition, to avoid double ingestion costs, consider collecting overlapped data on a single workspace only with Table level Azure RBAC.


## Next steps

For more information, see:

- [Pre-deployment activities and prerequisites for deploying Azure Sentinel](sample-workspace-designs.md)
- [Azure Sentinel workspace architecture best practices](workspace-architecture-best-practices.md)
- [Best practices for Azure Sentinel](best-practices.md)
