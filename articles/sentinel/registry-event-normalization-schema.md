---
title: Azure Sentinel Registry Event normalization schema reference | Microsoft Docs
description: This article describes the Azure Sentinel Registry Event normalization schema.
services: sentinel
cloud: na
documentationcenter: na
author: batamig
manager: rkarlin

ms.assetid:
ms.service: azure-sentinel
ms.subservice: azure-sentinel
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: reference
ms.date: 07/01/2021
ms.author: bagol

---

# Azure Sentinel Registry Event normalization schema reference (Public preview)

The Registry Event schema is used to describe the Windows activity of creating, modifying or deleting Windows Registry entities. 

Registry events are specific to Windows systems, but are reported by different systems that monitor Windows, such as EDR (End Point Detection and Response) systems, Sysmon, or Windows itself.

For more information about normalization in Azure Sentinel, see [Normalization and the Azure Sentinel Information Model (ASIM)](normalization.md).

> [!IMPORTANT]
> The Registry Event normalization schema is currently in public preview.
> This feature is provided without a service level agreement, and it's not recommended for production workloads.
> For more information, see [Supplemental Terms of Use for Microsoft Azure Previews](https://azure.microsoft.com/support/legal/preview-supplemental-terms/).

## Parsers

Azure Sentinel provides the following built-in, product-specific registry event parsers:

- **Security Events registry update (Event 4657**), collected using the Log Analytics Agent or Azure Monitor Agent
- **Sysmon registry monitoring events (Events 12, 13, and 14)**, collected using the Log Analytics Agent or Azure Monitor Agent
- **Microsoft 365 Defender for Endpoints registry events**

To use the source-agnostic parser that unifies all of the built-in parsers, and ensure that your analysis runs across all the configured sources, use **imRegistry** as the table name in your query.

Deploy the [source-agnostic and source-specific parsers](normalization.md#parsers) from the [Azure Sentinel GitHub repository](https://aka.ms/AzSentinelRegistry).

### Add your own normalized parsers

If you create KQL functions that implement custom parsers for Registry Event normalization, name the functions with the following syntax: `imRegistry<vendor><Product>`.

Add your KQL functions to the **imRegistry** source-agnostic parsers to ensure that any content that uses the Azure Sentinel Information Model registry event normalization schema also uses your new parser.


## Normalized content

Azure Sentinel provides the **Persisting Via IFEO Registry Key** hunting query. This query works on any registry activity data normalized using the Azure Sentinel Information Model.

## Schema details

The Registry Event information model is aligned is the [OSSEM Registry entity schema](https://github.com/OTRF/OSSEM/blob/master/docs/cdm/entities/registry.md).

Log Analytics Fields
The following fields are generated by Log Analytics for each record. You can override them when creating a custom connector. Note that Log Analytics adds additional fields, which are less relevant to security use cases and which are documented here.
Field	Type	Discussion
TimeGenerated	datetime	The time the event was generated by the reporting device.
_ResourceId	guid	The Azure Resource ID of the reporting device or service, or the log forwarder resource ID for events forwarded using Syslog, CEF or WEF.
Event Fields
Event fields are fields that are common to all schemas and describe the activity itself and the reporting device.
Field	Class	Type	Example
Discussion
EventMessage	Optional	String		A general message or description, either included in, or generated from, the record. 
EventCount	Mandatory	Integer	1	The number of events described by the record. This value is used when the source supports aggregation, and a single record may represent multiple events. For other sources, it should be set to 1.
EventStartTime	Mandatory	Date/time		If the source supports aggregation and the record represents multiple events, this field should specify the time the first event was generated. Otherwise, should alias "TimeGenerated". 
EventEndTime	Mandatory	Alias		Alias to TimeGenerated
EventType	Mandatory	Enumerated	RegistryKeyCreated	Indicate the operation reported by the record. For Process records, possible values will be:
•	RegistryKeyCreated
•	RegistryKeyDeleted
•	RegistryKeyRenamed
•	RegistryValueDeleted
•	RegistryValueSet
EventOriginalUid	Optional	String	69f37748-ddcd-4331-bf0f-b137f1ea83b	A unique ID of the original record, if provided by the source.
EventProduct	Mandatory	String	Sysmon	The product generating the event. This field may not be available in the source record and should be set by the parser.
EventProductVersion	Optional	String	12.1	The version of the product generating the event.
EventVendor	Mandatory	String	Microsoft	The vendor of the product generating the event. This field may not be available in the source record and should be set by the parser
EventSchemaVersion	Mandatory	String	0.1	The version of the schema document here is 0.1.
EventReportUrl	Optional	String		A URL provided in the event for a resource that provides additional information about the event.
Dvc	Alias	String	ContosoDc.Contoso.Azure	A unique identifier of the device on which the process event occurred. , aliasing DvcId, DvcHostname or DvcIp. 

DvcIpAddr	Recommended	IP Address	45.21.42.12	The IP Address of the device on which the process event occurred.
DvcHostname 	Recommended	Hostname	ContosoDc.Contoso.Azure	The hostname of the device on which the process event occurred. . 
DvcId	Optional	String	41502da5-21b7-48ec-81c9-baeea8d7d669	The unique ID of the device on which the process event occurred. 
DvcMacAddr	Optional	MAC	00:1B:44:11:3A:B7	The MAC  of device on which the process event occured..
DvcOs	Optional	String	Windows	The Operating System running on the device on which the process event occurred.
DvcOsVersion	Optional	String	10	The version of the operating system on the device on which the process event occurred.
AdditionalFields	Optional	Dynamic		If your source provides additional information worth preserving, either keep it with the original field names or create the dynamic field AdditionalFields and add to it the extra information as key/value pairs.

Registry Event specific fields
The fields below are specific to Registry events. That said, many of them do have similarities in other schemas and therefore follow the same naming convention.
Hint: To learn more about Registry structure, the what Registry Key, Value, Type and Data mean, refer to “Structure of the Registry”
Field	Class	Type	Example	Discussion
RegistryKey	Mandatory	String	HKEY_LOCAL_MACHINE\SOFTWARE\MTG	The Registry key, associated with the operation. Registry keys are analogous to folders in file systems.

RegistryKey should be normalized to standard root key naming as listed in the “root keys” table below.
RegistryValue	Recommended	String	Path	The Registry value associated with the operation. Registry values are analogous to files in file systems.
RegistryValueType	Recommended	String	Reg_Expand_Sz	The Type of the Registry value. 

The type should be normalized to the standard form as listed in the “value types” table below
RegistryValueData	Recommended	String	C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;	The data stored in the Registry Value.
RegistryPreviousKey	Recommended	String	HKEY_LOCAL_MACHINE\SOFTWARE\MTG	For operations that modify the registry, the original registry key. Registry keys are analogous to folders in file systems.

RegistryPreviousKey should be normalized to standard root key naming as listed in the “root keys” table below.

Note that if the operation changed other fields, such as value, but the key is the same, the 
RegistryPreviousKey will have the same value as RegistryKey.
RegistryPreviousValue	Recommended	String	Path	For operations that modify the registry, the original Registry value. Registry values are analogous to files in file systems.

Note that if the operation changed other fields, such as data, but the value is the same, the 
RegistryPreviousValue will have the same value as RegistryValue.
RegistryPreviousValueType	Recommended	String	Reg_Expand_Sz	For operations that modify the registry, the original value type. If the type was not changed, this field will have the same value as RegistryValueType.

The type should be normalized to the standard form as listed in the “value types” table below.
RegistryPreviiusValueData	Recommended	String	C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;	For operations that modify the registry, the original registry data.
User	Alias		CONTOSO\ dadmin	Alias to the ActorUsername.
Process	Alias		C:\Windows\System32\rundll32.exe	Alias to the ActingProcessName
ActorUsername	Mandatory	String	CONTOSO\ WIN-GG82ULGC9GO$	The username of the user who initiated the event
ActorUsernameType	Mandatory	Enumerated	Windows	Specifies the type of the user name stored in “ActorUsername” field. See the user entity documentation for details
ActorUserId	Recommended	String	S-1-5-18	A unique ID of the Actor. The specific ID depends on the system generating the event. See the user entity documentation for details.
ActorUserIdType	Recommended	String	SID	The type of the ID stored in the “ActorUserId” field. See the user entity documentation for details.
ActorSessionId	Optional	String	999	The unique ID of the login session of the Actor.

Note: the type is defined as string to support different systems, however on Windows it is numeric. If provided using a different notation, such as hexadecimal notation, it should be converted to decimal.
ActingProcessName	Optional	string	C:\Windows\explorer.exe	The file name of the image file of the acting process. This is usually considered the process name.
ActingProcessId	Mandatory	int	48610176	The process ID (PID) of the acting process.

Note: the type is defined as string to support different systems, however on Windows and Linux it is numeric. If provided using a different notation, such as hexadecimal notation, it should be converted to decimal.
ActingProcessGuid	Optional	string	EF3BD0BD-2B74-60C5-AF5C-010000001E00	A generated unique identifier (GUID) of the acting process.
ActingProcessTokenElevation	Optional	String	None	A token indicating the presence or absence of User Access Control (UAC) privilege elevation applied to the acting process.
ParentProcessName	Optional	string	See Acting Process
The file name of the image file of the parent process. This is considered the process name.
ParentProcessId	Mandatory	integer	See Acting Process	The process ID (PID) of the parent process.
ParentProcessGuid	Optional	String	See Acting Process	A generated unique identifier (GUID) of the parent process.

Root Keys
Different sources represent Registry key prefixes using different representations. The fields RegistryKey and RegistryPreviousKey should use the normalized prefixes listed below:

Normalized key prefix	Other common representations
HKEY_LOCAL_MACHINE	HKLM, \REGISTRY\MACHINE
HKEY_USERS	HKU, \REGISTRY\USER

Value Types
Different sources represent Registry types using different representations. The fields RegistryValueType and RegistryPreviousValueType should use a normalized types listed below:
Normalized type	Other common representations
Reg_None	None, %%1872
Reg_Sz	String, %%1873
Reg_Expand_Sz	ExpandString, %%1874
Reg_Binary	Binary, %%1875
Reg_DWord	Dword, %%1876
Reg_Multi_Sz	MultiString, %%1879
Reg_QWord	Qword, %%1883


## Next steps

For more information, see:

- [Normalization in Azure Sentinel](normalization.md)
- [Azure Sentinel network normalization schema reference](normalization-schema.md)
- [Azure Sentinel DNS normalization schema reference](dns-normalization-schema.md)
- [Azure Sentinel Authentication normalization schema reference (Public preview)](authentication-normalization-schema.md)
