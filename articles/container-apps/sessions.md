---
title: Azure Container Apps dynamic sessions overview
description: 
services: container-apps
author: craigshoemaker
ms.service: container-apps
ms.topic: conceptual
ms.date: 04/04/2024
ms.author: cshoe
---

# Azure Container Apps dynamic sessions overview

Azure Container Apps dynamic sessions provides fast access to secure sandboxed environments that are ideal for running code or applications that requires strong isolation from other workloads.

Sessions have the following attributes:

* **High isolation**: Sessions are isolated from each other and from the host environment. Each session runs in its own Hyper-V sandbox, providing enterprise-grade security and isolation. Optionally, you can enable network isolation to further enhance security.

* **Simple access**: Sessions are accessed through a REST API. Each session is identified by a unique identifier. If a session with a given identifier doesn't exist, a new session is automatically allocated.

* **Fully managed**: A session's lifecycle is automatically managed by the platform. They are automatically cleaned up when they are no longer in use.

* **Fast startup**: A new session is allocated in milliseconds. This is achieved by automatically maintaining a pool of ready but unallocated sessions.

* **Scalable**: Sessions can run at a high scale. You can run hundreds or thousands of sessions concurrently.

> [!NOTE]
> Azure Container Apps dynamic sessions is currently in preview.

## Session types

Azure Container Apps supports two types of sessions:

| Type | Description | Billing model |
|------|-------------|---------------|
| **Code interpreter** | Fully managed code interpreter | Per session (consumption) |
| **Custom container** | Bring your own container | Container Apps Dedicated Plan |

### Code interpreter

Code interpreter sessions allow you to run code in a sandbox that is preinstalled with popular libraries. They're ideal for running untrusted code, such as code provided by users of your application or code generated by a large language model (LLM). Learn more about [code interpreter sessions](./sessions-code-interpreter.md).

### Custom container

Custom container sessions allow you to run your own container images in secure, isolated sandboxes. You can use them to run a custom code interpreter for a language that isn't supported out of the box, or to run any other workload that requires strong isolation. Learn more about [custom container sessions](./sessions-custom-container.md).

## Concepts

The key concepts in Azure Container Apps dynamic sessions are session pools and sessions.

### Session pools

To provide sub-second session allocation times, Azure Container Apps maintains a pool of ready but unallocated sessions. When you submit a request to a new session, the platform allocates a session from the pool to you. As sessions are allocated, the platform automatically replenishes the pool to maintain a constant number of ready sessions.

There are a number of configurations that you can apply to session pools, such as the maximum number of sessions that can be allocated concurrently (`maxConcurrentSessions`) and the amount of time after the last request to a session before it's deleted (`cooldownPeriodInSeconds`). For custom container sessions, you can also specify the container image and settings to use for the sessions in the pool, as well as the number of sessions to keep ready in the pool (`readySessionInstances`).

### Sessions

A session is a sandboxed environment that runs your code or application. Each session is isolated from other sessions and from the host environment with a Hyper-V sandbox. Optionally, you can enable network isolation to further enhance security.

#### Session identifiers

When you interact with sessions in a pool, you use a session identifier to reference each session. If there's a running session with the identifier, the session is reused. If there's no running session with the identifier, a new session is automatically created.

The session identifier is a string that you define that is unique within the session pool. If you're building a web application, you can use the user's ID. If you're building a chatbot, you can use the conversation ID.

The identifier must be a string that is 4 to 128 characters long and can contain only alphanumeric characters and special characters from this list: `|`, `-`, `&`, `^`, `%`, `$`, `#`, `(`, `)`, `{`, `}`, `[`, `]`, `;`, `<`, and `>`.

You pass the session identifier in a query parameter named `identifier` in the URL when you make a request to a session.

#### Authentication

Authentication is handled using Microsoft Entra (formerly Azure Active Directory) tokens. The token must be a valid Microsoft Entra token generated by an identity that has the `Azure ContainerApps Session Creator` or `Contributor` role on the session pool.

If you're using the pool's management API endpoints directly, you must generate a token and include it in the `Authorization` header of your HTTP requests. In addition to the role assignments mentioned above, token must also contain an audience (`aud`) claim with the value `https://dynamicsessions.io`.

TODO: add instructions on how to generate a token with Azure CLI, and the Azure Identity library.

For code interpreter sessions, you can also use an integration with an LLM framework. The framework will handle the token generation and management for you. Ensure that the application has been configured with a managed identity that has the necessary role assignments on the session pool.

#### Lifecycle

Each session in a session pool has a lifecycle is automatically managed by the platform.

* **Pending**: When a session is starting up, it's in the pending state. The amount of time a session spends in the pending state depends on the container image and settings that you've specified for the session pool. A pending session is not added to the pool of ready sessions.

* **Ready**: When a session has finished starting up and is ready, it's added to the pool. The session is available to be allocated.

* **Allocated**: When you send a request to a session and there's not a running session with the given identifier, the platform allocates a session from the pool and transitions it to the allocated state. Subsequent requests with the same session identifier are routed to the same allocated session.

* **Deleting**: When a session hasn't received any requests for a period of time defined by the `cooldownPeriodInSeconds` setting, the session and its Hyper-V sandbox are completely and securely deleted.

## Security

Azure Container Apps dynamic sessions is built to run untrusted code and applications in a secure and isolated environment. While sessions are isolated from one another, anything within a single session, including files and environment variables, is accessible by users of the session. You should only configure or upload sensitive data to a session if you trust the users of the session.

## Next steps

> [!div class="nextstepaction"]
> [Code interpreter sessions](./sessions-code-interpreter.md)
