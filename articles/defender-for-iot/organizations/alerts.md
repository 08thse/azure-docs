---
title: Microsoft Defender for IoT alerts
description: Learn about Microsoft Defender for IoT alerts across the Azure portal, OT network sensors, and on-premises management consoles.
ms.date: 12/12/2022
ms.topic: how-to
---

# Microsoft Defender for IoT alerts

Microsoft Defender for IoT alerts enhance your network security and operations with real-time details about events logged in your network. Alerts are triggered when OT or Enterprise IoT network sensors detect changes or suspicious activity in network traffic that needs your attention.

For example:

:::image type="content" source="media/how-to-view-manage-cloud-alerts/main-alert-page.png" alt-text="Screenshot of the Alerts page in the Azure portal." lightbox="media/how-to-view-manage-cloud-alerts/main-alert-page.png":::

Use the details shown on the **Alerts** page, or on an alert details page, to investigate and take action that remediates any risk to your network, either from related devices or the network process that triggered the alertץ

> [!TIP]
> Use remediation steps to help your SOC teams understand OT issues and resolutions. We recommend that you review recommended remediation steps before updating an alert status or taking action on the device or network.
>

## Alert management options

Defender for IoT alerts are available in the following locations:

- **Defender for IoT in the Azure portal**, for all cloud-connected OT sensors and Enterprise IoT sensors
- **Each OT network sensor console**, for alerts generated by that sensor
- **The on-premises management console**, for alerts generated by connected OT sensors

In each location, view alert details about when the alert was detected and investigate the alert with surrounding context, such as the traffic's source and destination devices.

The Azure portal and OT network sensors also provide the following extra investigation and alert management options:

|Location  |Extra options  |
|---------|---------|
|**Alerts on the Azure portal**     | - View related MITRE ATT&CK tactics and techniques <br>- Use out-of-the-box workbooks for visibility into high priority alerts <br>- View alerts from Microsoft Sentinel and run deeper investigations with [Microsoft Sentinel playbooks and workbooks](concept-sentinel-integration.md).        |
|**OT network sensors and איק on-premises management console**     | - On an OT sensor console, view the alert's source and destination in the **Device map**, and view related events on the **Event timeline**.  <br>- Accelerate alert workflows with custom alert rules and comments.  <br>- Forward sensor alerts to directly to partner vendors, including SIEM systems, MSSP systems, and more.      |

For more information, see:

- [Azure user roles and permissions for Defender for IoT](roles-azure.md)
- [On-premises users and roles for OT monitoring with Defender for IoT](roles-on-premises.md)

### Enterprise IoT alerts

If you have an [Enterprise IoT plan](eiot-defender-for-endpoint.md) with Microsoft Defender for Endpoint, alerts for Enterprise IoT devices detected by Microsoft Defender for Endpoint are available in Defender for Endpoint only.

For more information, see [Securing IoT devices in the enterprise](concept-enterprise.md) and the [Alerts queue in Microsoft 365 Defender](/microsoft-365/security/defender-endpoint/alerts-queue-endpoint-detection-response).

## Learning OT alert traffic

Some alerts might reflect valid network changes, such as an authorized device attempting to access a new resource on another device.

If you don't want to see the alert again for the same traffic pattern, instruct Defender for IoT to *learn* the traffic for its network baseline.

While you can *learn* alerts on the Azure portal or on OT network sensors, you can only *unlearn* alerts on the OT network sensor.

After you've *learned* an alert, the alert is automatically closed, and the learn action is added to the alert's **Event Timeline**. Devices related to the learned traffic, including source and destination devices, aren't calculated when the sensor generates reports, such as [Risk assessment](how-to-create-risk-assessment-reports.md) or [Attack vector](how-to-create-attack-vector-reports.md) reports.

Other examples of traffic you might want to *Learn* include:

- Firmware version changes following standard maintenance procedures.

- A new device is added to the network.

- A new device performed a read/write operation on a destination controller.

- A new device performs a read/write operation on a destination controller and should be defined as a programming device.

- New legitimate scanning is carried out and the device should be defined as a scanning device.

> [!TIP]
> If you know ahead of time which events are irrelevant for you, such as during a maintenance window, or if you don't want to track the event in the event log, [create an alert exclusion rule](how-to-accelerate-alert-incident-response.md#create-alert-exclusion-rules-on-an-on-premises-management-console) on an on-premises management console instead.
>

### Muting alert traffic

Learning an alert isn't supported for alerts generated by the *Anomaly*, *Protocol Violation*, or *Operational* engines. To instruct your sensor to ignore such alerts, sign into your OT sensor or on-premises management console and mute the alert instead.

Examples of when you'd mute traffic include:

  - The Anomaly engine triggers an alert on a spike in bandwidth between two devices, but the spike is valid for these devices.

  - The Protocol Violation engine triggers an alert on a protocol deviation detected between two devices, but the deviation is valid between the devices.

  - The Operational engine triggers an alert indicating that the PLC Mode was changed on a device. The new mode may indicate that the PLC isn't secure, but after investigation, it's determined that the new mode is acceptable.


## Managing OT alerts in a hybrid deployment

Users working in hybrid deployments may be managing alerts in Defender for IoT on the Azure portal, the sensor, and an on-premises management console.

Alert statuses are fully synchronized between the Azure portal and the sensor, and between the sensor and the on-premises management console. This means that regardless of where you manage the alert in Defender for IoT, the alert is updated in other locations as well.

Setting an alert status to **Closed** or **Muted** on a sensor or on-premises management console updates the alert status to **Closed** on the Azure portal.

> [!TIP]
> If you're working with Microsoft Sentinel, we recommend that you configure the integration to also  [synchronize alert status](concept-sentinel-integration.md#defender-for-iot-alerts-in-microsoft-sentinel) with Microsoft Sentinel.
>
## Accelerating OT alert workflows

New alerts are automatically closed if no identical traffic is detected 14 days after the initial detection. If identical traffic is detected after the initial 14 days, the 14-day count for network traffic is reset.

In addition to the default behavior, you may want to help your SOC and OT management teams triage and remediate alerts faster. Sign into an OT network sensor as an **Admin** user for any of the following options:

- **Create custom alert rules**. Add custom alert rules to trigger alerts for specific activity on your network that's not covered by out-of-the-box functionality.

    For example, for an environment running MODBUS, you might add a rule to detect any written commands to a memory register on a specific IP address and ethernet destination.

    For more information, see [Create custom alert rules on an OT sensor](how-to-accelerate-alert-incident-response.md#create-custom-alert-rules-on-an-ot-sensor).

- **Create custom alert comments**. Create a set of custom alert comments that other OT sensor users can add to individual alerts, with details like custom mitigation steps, communications to other team members, or other insights or warnings about the event.

    As team members triage alerts, they can reuse any of these custom comments. Alert comments are shown in a comments area on an alert details page. For example:

    :::image type="content" source="media/alerts/alert-comments.png" alt-text="Screenshot of the alert comments area.":::

    For more information, see [Create custom alert comments on an OT sensor](how-to-accelerate-alert-incident-response.md#create-custom-alert-comments-on-an-ot-sensor).

- **Create alert exclusion rules**: If you're working with an on-premises management console, define *alert exclusion rules* to ignore events across multiple sensors that meet specific criteria. For example, you might create an alert exclusion rule to ignore all events that would trigger irrelevant alerts during a specific maintenance window.

    Alerts ignored by exclusion rules aren't shown on the Azure portal, sensor, or on-premises management console, or in the event logs.

    For more information, see [Create alert exclusion rules on an on-premises management console](how-to-accelerate-alert-incident-response.md#create-alert-exclusion-rules-on-an-on-premises-management-console).

- **Forward alert data to partner systems**, including SIEMs, syslog servers, email addresses and more. Forward alert data directly from an OT sensor or the on-premises management console.

    For more information, see [Forward alert information](how-to-forward-alert-information-to-partners.md).

## OT alert data retention
<!--update with Shereen's PR-->
On an OT network sensor:

- New alerts are automatically closed if no identical traffic detected is 14 days after  initial detection. After 90 days of being closed, the alert is removed from the sensor.

- If identical traffic is detected after the initial 14 days, the 14-day count for network traffic is reset.

Updating an alert’s status, learning the alert, or muting the alert doesn’t affect how long the alert is displayed.

<!--missing more info. is this replicated to the portal? cm? sentinel?-->

## Next steps

Review alert types and messages to help you understand and plan remediation actions and playbook integrations. For more information, see [OT monitoring alert types and descriptions](alert-engine-messages.md).

- Investigate OT alerts <!--add link when ready-->
- [View and manage alerts from the Azure portal](how-to-manage-cloud-alerts.md)
- [View and manage alerts on your OT sensor](how-to-view-alerts.md)
- [Work with alerts on the on-premises management console](how-to-work-with-alerts-on-premises-management-console.md)
