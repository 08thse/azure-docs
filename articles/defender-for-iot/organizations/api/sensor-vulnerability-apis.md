---
title: Vulnerability management API reference for OT monitoring sensors - Microsoft Defender for IoT
description: Learn about the vulnerability management REST APIs supported for Microsoft Defender for IoT OT monitoring sensors.
ms.date: 05/25/2022
ms.topic: reference
---

# Vulnerability management API reference for OT monitoring sensors

This article lists the vulnerability management REST APIs supported for Microsoft Defender for IoT OT monitoring sensors.

## device vulnerabilities (Retrieve device vulnerability information)

Use this API to request vulnerability assessment results for each device.

**URI**: `/api/v1/reports/vulnerabilities/devices`

### GET

# [Response](#tab/devices-response)

**Type**: JSON

Array of JSON objects that represent assessed devices.

**Device fields**:

| Name | Type | Nullable | List of values |
|--|--|--|--|
| **name** | String | Required | - |
| **ipAddresses** | JSON array | Required | - |
| **securityScore** | Numeric | Required | - |
| **vendor** | String | Optional |  |
| **firmwareVersion** | String | Optional | - |
| **model** | String | Optional | - |
| **isWirelessAccessPoint** | Boolean | Required | True or false |
| **operatingSystem** | Operating system object | Optional | - |
| **vulnerabilities** | Vulnerabilities object | Optional | - |

**Operating system fields**:

| Name | Type | Nullable | List of values |
|--|--|--|--|
| **Name** | String | Optional | - |
| **Type** | String | Optional | - |
| **Version** | String | Optional | - |
| **latestVersion** | String | Optional | - |

**Vulnerabilities fields**:

| Name | Type | Nullable | List of values |
|--|--|--|--|
| **antiViruses** | JSON array | Optional | Antivirus names |
| **plainTextPasswords** | JSON array | Optional | Password objects |
| **remoteAccess** | JSON array | Optional | Remote access objects |
| **isBackupServer** | Boolean | Required | True or false |
| **openedPorts** | JSON array | Optional | Opened port objects |
| **isEngineeringStation** | Boolean | Required | True or false |
| **isKnownScanner** | Boolean | Required | True or false |
| **cves** | JSON array | Optional | CVE objects |
| **isUnauthorized** | Boolean | Required | True or false |
| **malwareIndicationsDetected** | Boolean | Required | True or false |
| **weakAuthentication** | JSON array | Optional | Detected applications that are using weak authentication |

**Password fields**:

| Name | Type | Nullable | List of values |
|--|--|--|--|
| **password** | String | Required | - |
| **protocol** | String | Required | - |
| **strength** | String | Required | Very weak, Weak, Medium, or Strong |

**Remote access fields**:

| Name | Type | Nullable | List of values |
|--|--|--|--|
| **port** | Numeric | Required | - |
| **transport** | String | Required | TCP or UDP |
| **client** | String | Required | IP address |
| **clientSoftware** | String | Required | SSH, VNC, Remote desktop, or Team viewer |

**Open port fields**

| Name | Type | Nullable | List of values |
|--|--|--|--|
| **port** | Numeric | Required | - |
| **transport** | String | Required | TCP or UDP |
| **protocol** | String | Optional | - |
| **isConflictingWithFirewall** | Boolean | Required | True or false |

**CVE fields**

| Name | Type | Nullable | List of values |
|--|--|--|--|
| **ID** | String | Required | - |
| **score** | Numeric | Required | Double |
| **description** | String | Required | - |

**Response example**:

```rest
[
    {
        "name": "IED \#10",
        "ipAddresses": ["10.2.1.10"],
        "securityScore": 100,
        "vendor": "ABB Switzerland Ltd, Power Systems",
        "firmwareVersion": null,
        "model": null,
        "operatingSystem": {
            "name": "ABB Switzerland Ltd, Power Systems",
            "type": "abb",
            "version": null,
            "latestVersion": null
        },
        "vulnerabilities": {
        "antiViruses": [
        "McAfee"
        ],
        "plainTextPasswords": [
            {
                "password": "123456",
                "protocol": "HTTP",
                "lastSeen": 1462726930471,
                "strength": "Very Weak"
            }
        ],
        "remoteAccess": [
            {
                "port": 5900,
                "transport": "TCP",
                "clientSoftware": "VNC",
                "client": "10.2.1.20"
            }
        ],
        "isBackupServer": true,
        "openedPorts": [
            {
                "port": 445,
                "transport": "TCP",
                "protocol": "SMP Over IP",
                "isConflictingWithFirewall": false
            },
            {
                "port": 80,
                "transport": "TCP",
                "protocol": "HTTP",
                "isConflictingWithFirewall": false
            }
        ],
        "isEngineeringStation": false,
        "isKnownScanner": false,
        "cves": [
            {
                "id": "CVE-2015-6490",
                "score": 10,
                "description": "Frosty URL - Stack-based buffer overflow on Allen-Bradley MicroLogix 1100 devices before B FRN 15.000 and 1400 devices through B FRN 15.003 allows remote attackers to execute arbitrary code via unspecified vectors"
            },
            {
                "id": "CVE-2012-6437",
                "score": 10,
                "description": "MicroLogix 1100 and 1400 do not properly perform authentication for Ethernet firmware updates, which allows remote attackers to execute arbitrary code via a Trojan horse update image"
            },
            {
                "id": "CVE-2012-6440",
                "score": 9.3,
                "description": "MicroLogix 1100 and 1400 allows man-in-the-middle attackers to conduct replay attacks via HTTP traffic."
            }
        ],
        "isUnauthorized": false,
        "malwareIndicationsDetected": true
        }
    }
]
```

# [Curl command](#tab/devices-curl)

**Type**: GET

**API**:

```rest
curl -k -H "Authorization: <AUTH_TOKEN>" https://<IP_ADDRESS>/api/v1/reports/vulnerabilities/devices
```

**Example**:

```
curl -k -H "Authorization: 1234b734a9244d54ab8d40aedddcabcd" https://127.0.0.1/api/v1/reports/vulnerabilities/devices
```

---
## security (Retrieve security vulnerabilities)

Use this API to request results of a general vulnerability assessment. This assessment provides insight into your system's security level.

This assessment is based on general network and system information and not on a specific device evaluation.

**URI**: `/api/v1/reports/vulnerabilities/security`

### GET

# [Response](#tab/security-response)

**Type**: JSON

JSON object that represents assessed results. Each key can be nullable. Otherwise, it will contain a JSON object with non-nullable keys.

**unauthorizedDevices fields**

| Field name | Type | List of values |
| ---------- | ---- | -------------- |
| **address** | String | IP address |
| **name** | String | - |
| **firstDetectionTime** | Numeric | Epoch (UTC) |
| lastSeen | Numeric | Epoch (UTC) |

**illegalTrafficByFirewallRules fields**

| Field name | Type | List of values |
| ---------- | ---- | -------------- |
| **server** | String | IP address |
| **client** | String | IP address |
| **port** | Numeric | - |
| **transport** | String | TCP, UDP, or ICMP |

**weakFirewallRules fields**

| Field name | Type | List of values |
| ---------- | ---- | -------------- |
| **sources** | JSON array of sources. Each source can be in any of four formats. | "Any", "ip address (Host", "from ip-to ip (RANGE)", "ip address, subnet mask (NETWORK)" |
| **destinations** | JSON array of destinations. Each destination can be in any of four formats. | "Any", "ipaddress (Host)", "from ip-to ip (RANGE)", "ip address, subnet mask (NETWORK)" |
| **ports** | JSON array of ports in any of three formats | "Any", "port (protocol, if detected)", "fromport-to port (protocol, if detected)" |

**accessPoints fields**

| Field name | Type | List of values |
| ---------- | ---- | -------------- |
| **macAddress** | String | MAC address |
| **vendor** | String | Vendor name |
| **ipAddress** | String | IP address, or N/A |
| **name** | String | Device name, or N/A |
| **wireless** | String | No, Suspected, or Yes |

**connectionsBetweenSubnets fields**

| Field name | Type | List of values |
| ---------- | ---- | -------------- |
| **server** | String | IP address |
| **client** | String | IP address |

**industrialMalwareIndicators fields**

| Field name | Type | List of values |
| ---------- | ---- | -------------- |
| **detectionTime** | Numeric | Epoch (UTC) |
| **alertMessage** | String | - |
| **description** | String | - |
| **devices** | JSON array | Device names |

**internetConnections fields**

| Field name | Type | List of values |
| ---------- | ---- | -------------- |
| **internalAddress** | String | IP address |
| **authorized** | Boolean | Yes or No |
| **externalAddresses** | JSON array | IP address |

**Response example**:

```rest
{
    "unauthorizedDevices": [
        {
            "address": "10.2.1.14",
            "name": "PLC \#14",
            "firstDetectionTime": 1462645483000,
            "lastSeen": 1462645495000,
        }
    ],
    "redundantFirewallRules": [
        {
            "sources": "170.39.3.0/255.255.255.0",
            "destinations": "Any",
            "ports": "102"
        }
    ],
    "connectionsBetweenSubnets": [
        {
            "server": "10.2.1.22",
            "client": "170.39.2.0"
        }
    ],
    "industrialMalwareIndications": [
        {
            "detectionTime": 1462645483000,
            "alertMessage": "Suspicion of Malicious Activity (Regin)",
            "description": "Suspicious network activity was detected. Such behavior might be attributed to the Regin malware.",
            "addresses": [
                "10.2.1.4",
                "10.2.1.5"
            ]
        }
    ],
    "illegalTrafficByFirewallRules": [
        {
            "server": "10.2.1.7",
            "port": "20000",
            "client": "10.2.1.4",
            "transport": "TCP"
        },
        {
            "server": "10.2.1.8",
            "port": "20000",
            "client": "10.2.1.4",
            "transport": "TCP"
        },
        {
            "server": "10.2.1.9",
            "port": "20000",
            "client": "10.2.1.4",
            "transport": "TCP"
        }
    ],
    "internetConnections": [
        {
            "internalAddress": "10.2.1.1",
            "authorized": "Yes",
            "externalAddresses": ["10.2.1.2",”10.2.1.3”]
        }
    ],
    "accessPoints": [
        {
            "macAddress": "ec:08:6b:0f:1e:22",
            "vendor": "TP-LINK TECHNOLOGIES",
            "ipAddress": "173.194.112.22",
            "name": "Enterprise AP",
            "wireless": "Yes"
        }
    ],
    "weakFirewallRules": [
        {
            "sources": "170.39.3.0/255.255.255.0",
            "destinations": "Any",
            "ports": "102"
        }
    ]
}
```

# [Curl command](#tab/security-curl)

**Type**: GET

**APIs**:

```rest
curl -k -H "Authorization: <AUTH_TOKEN>" https://<IP_ADDRESS>/api/v1/reports/vulnerabilities/security
```

**Example**:

```
curl -k -H "Authorization: 1234b734a9244d54ab8d40aedddcabcd" https://127.0.0.1/api/v1/reports/vulnerabilities/security
```
---

## operational (Retrieve operational vulnerabilities)

Use this API to request results of a general vulnerability assessment. This assessment provides insight into the operational status of your network. It's based on general network and system information and not on a specific device evaluation.

**URI**: `/api/v1/reports/vulnerabilities/operational`

# [Request](#tab/operational-request)

**Type**: GET

# [Response](#tab/operational-response)

**Type**: JSON

JSON object that represents assessed results. Each key contains a JSON array of results.


**backupServer result fields**

| Field name | Type | List of values |
|--|--|--|
| **source** | String | IP address |
| **destination** | String | IP address |
| **port** | Numeric | - |
| **transport** | String | TCP or UDP |
| **backupMaximalInterval** | String | - |
| **lastSeenBackup** | Numeric | Epoch (UTC) |

**ipNetworks result fields**

| Field name | Type | List of values |
|--|--|--|
| **addresse**s | Numeric | - |
| **network** | String | IP address |
| **mask** | String | Subnet mask |

**protocolProblems result fields**

| Field name | Type | List of values |
|--|--|--|
| **protocol** | String | - |
| **addresses** | JSON array | IP addresses |
| **alert** | String | - |
| **reportTime** | Numeric | Epoch (UTC) |

**protocolDataVolumes result fields**

| Field name | Type | List of values |
|--|--|--|
| protocol | String | - |
| volume | String | "volume number MB" |

**disconnections result fields**

| Field name | Type | List of values |
|--|--|--|
| **assetAddress** | String | IP address |
| **assetName** | String | - |
| **lastDetectionTime** | Numeric | Epoch (UTC) |
| **backToNormalTime** | Numeric | Epoch (UTC) |

**Response example**

```rest
{
    "backupServer": [
        {
            "backupMaximalInterval": "1 Hour, 29 Minutes",
            "source": "10.2.1.22",
            "destination": "170.39.2.14",
            "port": 10000,
            "transport": "TCP",
            "lastSeenBackup": 1462645483000
        }
    ],
    "ipNetworks": [
        {
            "addresses": "21",
            "network": "10.2.1.0",
            "mask": "255.255.255.0"
        },
        {
            "addresses": "3",
            "network": "170.39.2.0",
            "mask": "255.255.255.0"
        }
    ],
    "protocolProblems": [
        {
            "protocol": "DNP3",
            "addresses": [
                "10.2.1.7",
                "10.2.1.8"
            ],
            "alert": "Illegal DNP3 Operation",
            "reportTime": 1462645483000
        },
        {
            "protocol": "DNP3",
            "addresses": [
                "10.2.1.15"
            ],
            "alert": "Master Requested an Application Layer Confirmation",
            "reportTime": 1462645483000
        }
    ],
    "protocolDataVolumes": [
        {
            "protocol": "MODBUS (502)",
            "volume": "21.07 MB"
        },
        {
            "protocol": "SSH (22)",
            "volume": "0.001 MB"
        }
    ],
    "disconnections": [
        {
            "assetAddress": "10.2.1.3",
            "assetName": "PLC \#3",
            "lastDetectionTime": 1462645483000,
            "backToNormalTime": 1462645484000
        }
    ]
}
```

# [Curl command](#tab/operational-curl)

**Type**: GET

**APIs**:

```rest
curl -k -H "Authorization: <AUTH_TOKEN>" https://<IP_ADDRESS>/api/v1/reports/vulnerabilities/operational
```

**Example**:

```rest
curl -k -H "Authorization: 1234b734a9244d54ab8d40aedddcabcd" https://127.0.0.1/api/v1/reports/vulnerabilities/operational
```

---

## mitigation (Retrieve mitigation vulnerabilities)

TBD

## Next steps

For more information, see the [Defender for IoT API reference overview](../references-work-with-defender-for-iot-apis.md).