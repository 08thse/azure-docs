---
title: Onboard a trial subscription of Azure Defender for IoT
description: In this tutorial, learn how to onboard a sensor and management console to try out Defender for IoT for free.
author: ElazarK
ms.author: v-ekrieg
ms.topic: tutorial
ms.date: 08/23/2021
ms.custom: template-tutorial
---

# Tutorial: Onboard a trial subscription of Azure Defender for IoT

This tutorial will help you learn how to onboard a trial subscription of Azure Defender for IoT by downloading

Through the use of virtual environments along with the software needed to create a sensor, and a management console, Defender for IoT allows you to:

- Use passive, agentless network monitoring to gain a complete inventory of all your IoT, and OT devices, their details, and how they communicate, with zero impact on the IoT/OT network.

- Identify risks and vulnerabilities in your IoT/OT environment. For example, identify unpatched devices, open ports, unauthorized applications, and unauthorized connections. You can also identify changes to device configurations, PLC code, and firmware.

- Detect anomalous or unauthorized activities with specialized IoT/OT-aware threat intelligence and behavioral analytics. You can even detect advanced threats missed by static IOCs, like zero-day malware, fileless malware, and living-off-the-land tactics.

- Integrate into Azure Sentinel for a bird's-eye view of your entire organization. Implement unified IoT/OT security governance with integration into your existing workflows, including third-party tools like Splunk, IBM QRadar, and ServiceNow.

In this tutorial, you learn how to:

> [!div class="checklist"]
> Onboard with Azure Defender for IoT
> Create and install the virtual management console
> Create and install the virtual sensor
> Activate the on-premises management console

## Prerequisites

- Permissions: Azure **Subscription Owners**, or **Subscription Contributors** level.

- At least one device to monitor connected to a SPAN port on the switch.

- Either VMware (ESXi 5.5 or later), or Hyper-V hypervisor (Windows 10 Pro or Enterprise) is installed and operational.

- An Azure account. If you do not already have an Azure account you can [create your Azure free account today](https://azure.microsoft.com/free/).

## Onboard with Azure Defender for IoT

To get started with Azure Defender for IoT, you must have a Microsoft Azure subscription. If you do not have a subscription, you can sign up for a free account.

To evaluate Defender for IoT, you can use a trial subscription. The trial is valid for 30 days and supports up to 1000 committed devices. The trial allows you deploy a virtual sensor on your network. Use the sensors to monitor traffic, analyze data, generate alerts, learn about network risks and vulnerabilities, and more. The trial also allows you to deploy a virtual on-premises management console to view the aggregated information generated by the sensor.

**To onboard a subscription**:

1. Navigate to the [Azure portal](https://ms.portal.azure.com/).

1. Search for, and select **Azure Defender for IoT**.

1. Select **Onboard subscription**.

    :::image type="content" source="media/tutorial-onboarding/onboard-subscription.png" alt-text="Select the Onboard subscription button from the Getting started page.":::

1. On the Pricing page select **Start with a trial**.

   :::image type="content" source="media/tutorial-onboarding/start-with-trial.png" alt-text="Select the Start with a trial button to open the trial window.":::

1. Select a subscription from the Onboard trial subscription pane and then select **Evaluate**.

1. Confirm your evaluation.

## Download the ISO for the virtual sensor and management console

The virtual appliances have minimum specifications that are required for both the sensor and management console. The following tables show the specifications needed depending on you environment.

### Virtual sensor

| Type | Corporate | Enterprise | SMB |
|--|--|--|--|
| vCPU | 32 | 8 | 4 |
| Memory | 32 GB | 32 GB | 8 GB |
| Storage | 5.6 TB | 1.8 TB | 500 GB |

**To download the ISO file for the virtual sensor**:

1. Navigate to the [Azure portal](https://ms.portal.azure.com/).

1. Search for, and select **Azure Defender for IoT**.

1. On the Getting started page, select the **Sensor** tab.

1. Select **Download**.

    :::image type="content" source="media/tutorial-onboarding/sensor-download.png" alt-text="Under the sensor tab, select download, to download the ISO file for the virtual sensor.":::

### Virtual management console

| Type | Enterprise |
|--|--|
| Description | Virtual appliance for enterprise deployment types |
| vCPU | 8 |
| Memory | 32 GB |
| Storage | 1.8 TB |

**To download the ISO file for the virtual management console**:

1. Navigate to the [Azure portal](https://ms.portal.azure.com/).

1. Search for, and select **Azure Defender for IoT**.

1. On the Getting started page, select the **On-premises management console** tab.

1. Select **Download**.

    :::image type="content" source="media/tutorial-onboarding/console-management-download.png" alt-text="Under the On-premises management console tab, select download, to download the ISO file for the virtual management console.":::

## Create and install the virtual management console

The on-premises management console VM supports any of the following architectures:

| Architecture | Specifications | Usage |
|--|--|--|
| **Enterprise** <br/>(Default and most common) | CPU: 8 <br/>Memory: 32G RAM<br/> HDD: 1.8 TB | Large production environments |
| **Small** | CPU: 4 <br/> Memory: 8G RAM<br/> HDD: 500 GB | Large production environments |
| **Office** | CPU: 4 <br/>Memory: 8G RAM <br/> HDD: 100 GB | Small test environments |

The on-premises management console supports both VMware and Hyper-V deployment options. Before you begin the installation, verify the following:

- VMware (ESXi 5.5 or later) or Hyper-V hypervisor (Windows 10 Pro or Enterprise) is installed and operational.

- The hardware resources are available for the virtual machine.

- You have the ISO installation file for the on-premises management console.

- The hypervisor is running.

### Create the virtual machine for the management console (ESXi)

**To a create virtual machine (ESXi)**:

1. Sign in to the ESXi, choose the relevant **datastore**, and select **Datastore Browser**.

1. Upload the image and select **Close**.

1. Go to **Virtual Machines**.

1. Select **Create/Register VM**.

1. Select **Create new virtual machine** and select **Next**.

1. Add a sensor name and choose:

   - Compatibility: \<latest ESXi version>

   - Guest OS family: Linux

   - Guest OS version: Ubuntu Linux (64-bit)

1. Select **Next**.

1. Choose relevant datastore and select **Next**.

1. Change the virtual hardware parameters according to the required [architecture](#create-and-install-the-virtual-management-console).

1. For **CD/DVD Drive 1**, select **Datastore ISO file** and choose the ISO file that you uploaded earlier.

1. Select **Next** > **Finish**.

### Create the virtual machine for the management console (Hyper-V)

**To create a virtual machine by using Hyper-V**:

1. Create a virtual disk in Hyper-V Manager.

1. Select the format **VHDX**.

1. Select **Next**.

1. Select the type **Dynamic expanding**.

1. Select **Next**.

1. Enter the name and location for the VHD.

1. Select **Next**.

1. Enter the required size (according to the [architecture](#create-and-install-the-virtual-management-console)).

1. Select **Next**.

1. Review the summary and select **Finish**.

1. On the **Actions** menu, create a new virtual machine.

1. Select **Next**.

1. Enter a name for the virtual machine.

1. Select **Next**.

1. Select **Generation** and set it to **Generation 1**.

1. Select **Next**.

1. Specify the memory allocation (according to the [architecture](#create-and-install-the-virtual-management-console)) and select the check box for dynamic memory.

1. Select **Next**.

1. Configure the network adaptor according to your server network topology.

1. Select **Next**.

1. Connect the VHDX created previously to the virtual machine.

1. Select **Next**.

1. Review the summary and select **Finish**.

1. Right-click the new virtual machine, and then select **Settings**.

1. Select **Add Hardware** and add a new adapter for **Network Adapter**.

1. For **Virtual Switch**, select the switch that will connect to the sensor management network.

1. Allocate CPU resources (according to the [architecture](#create-and-install-the-virtual-management-console)).

1. Connect the management console's ISO image to a virtual DVD drive.

1. Start the virtual machine.

1. On the **Actions** menu, select **Connect** to continue the software installation.

### Install the management console software (ESXi and Hyper-V)

Either ESXi, or Hyper-V can be used to install the software for the management console. 

**To install the management console software**:

1. Open the virtual machine console.

1. The VM will start the installation process from the ISO image and the language selection screen will appear. Select **English**.

1. Select the required [architecture](#create-and-install-the-virtual-management-console) for your deployment.

1. Define the network interface for the sensor management network: interface, IP, subnet, DNS server, and default gateway.

1. Sign-in credentials are automatically generated. Save the username and passwords, you'll need these credentials to access the platform the first time you use it.

   The appliance will then reboot.

1. Access the management console via the IP address previously configured: `<https://ip_address>`.

## Create and install the virtual sensor

The sensor VM supports any of the following architectures:

| Architecture | Specifications | Usage | Comments |
|--|--|--|--|
| **Enterprise** | CPU: 8<br/>Memory: 32G RAM<br/>HDD: 1800 GB | Production environment | Default and most common |
| **Small Business** | CPU: 4 <br/>Memory: 8G RAM<br/>HDD: 500 GB | Test or small production environments | - |
| **Office** | CPU: 4<br/>Memory: 8G RAM<br/>HDD: 100 GB | Small test environments | - |

The on-premises management console supports both VMware and Hyper-V deployment options. Before you begin the installation, make sure you have the following items:

- VMware (ESXi 5.5 or later) or Hyper-V hypervisor (Windows 10 Pro or Enterprise) installed and operational

- Available hardware resources for the virtual machine

- ISO installation file for the Azure Defender for IoT sensor

- Make sure the hypervisor is running.

### Create the virtual machine for the sensor (ESXi)

**To create the virtual machine for the sensor (ESXi)**:

1. Sign in to the ESXi, choose the relevant **datastore**, and select **Datastore Browser**.

1. **Upload** the image and select **Close**.

1. Go to **Virtual Machines**, and then select **Create/Register VM**.

1. Select **Create new virtual machine**, and then select **Next**.

1. Add a sensor name and choose:

   - Compatibility: **&lt;latest ESXi version&gt;**

   - Guest OS family: **Linux**

   - Guest OS version: **Ubuntu Linux (64-bit)**

1. Select **Next**.

1. Choose the relevant datastore and select **Next**.

1. Change the virtual hardware parameters according to the required [architecture](#create-and-install-the-virtual-sensor).

1. For **CD/DVD Drive 1**, select **Datastore ISO file** and choose the ISO file that you uploaded earlier.

1. Select **Next** > **Finish**.

### Create the virtual machine for the sensor (Hyper-V)

This procedure describes how to create a virtual machine by using Hyper-V.

**To create a virtual machine**:

1. Create a virtual disk in Hyper-V Manager.

1. Select **format = VHDX**.

1. Select **type = Dynamic Expanding**.

1. Enter the name and location for the VHD.

1. Enter the required size (according to the [architecture](#create-and-install-the-virtual-sensor)).

1. Review the summary and select **Finish**.

1. On the **Actions** menu, create a new virtual machine.

1. Enter a name for the virtual machine.

1. Select **Specify Generation** > **Generation 1**.

1. Specify the memory allocation (according to the [architecture](#create-and-install-the-virtual-sensor)) and select the check box for dynamic memory.

1. Configure the network adaptor according to your server network topology.

1. Connect the VHDX created previously to the virtual machine.

1. Review the summary and select **Finish**.

1. Right-click the new virtual machine and select **Settings**.

1. Select **Add Hardware** and add a new network adapter.

1. Select the virtual switch that will connect to the sensor management network.

1. Allocate CPU resources (according to the [architecture](#create-and-install-the-virtual-sensor)).

1. Connect the management console's ISO image to a virtual DVD drive.

1. Start the virtual machine.

1. On the **Actions** menu, select **Connect** to continue the software installation.

### Install the virtual sensor software (ESXi and Hyper-V)

Either ESXi, or Hyper-V can be used to install the software for the sensor.

**To install the software on the virtual sensor**:

1. Open the virtual machine console.

1. The VM will start from the ISO image, and the language selection screen will appear. Select **English**.

1. Select the required [architecture](#create-and-install-the-virtual-sensor).

1. Define the appliance profile and network properties:

    | Parameter | Configuration |
    | ----------| ------------- |
    | **Hardware profile** | Based on the required [architecture](#create-and-install-the-virtual-sensor). |
    | **Management interface** | **ens192** |
    | **Network parameters (provided by the customer)** | **management network IP address:** <br/>**subnet mask:** <br>**appliance hostname:** <br/>**DNS:** <br/>**default gateway:** <br/>**input interfaces:**|
    | **bridge interfaces:** | There's no need to configure the bridge interface. This option is for special use cases only. |

1. Enter **Y** to accept the settings.

1. Sign-in credentials are automatically generated and presented. Copy the username and password in a safe place, because they're required for sign-in, and administration. The username and password will not be presented again.

    - **Support**: The administrative user for user management.

    - **CyberX**: The equivalent of root for accessing the appliance.

1. The appliance restarts.

1. Access the management console via the IP address previously configured: `https://ip_address`.

### Post-installation validation

To validate the installation of a physical appliance, you need to perform many tests. The same validation process applies to all the appliance types.

The validation is available to both the **Support**, and **CyberX** user.

:::image type="content" source="media/tutorial-install-components/system-health-check-screen.png" alt-text="Screenshot that shows the system health check.":::

**To access the post validation tool**:

1. Sign in to the sensor.

1. Select **System Settings** from the left side pane.

1. Select **System Statistics**.

    :::image type="icon" source="media/tutorial-install-components/system-statistics-icon.png" border="false":::

For post-installation validation, you must test to ensure the system is running, that you have the right version, and to verify that all of the input interfaces that were configured during the installation process are running.

**To verify that the system is running**:

1. Select **Appliance**, and ensure that each line item shows `Running` and the bottom line states `System is up`.

1. Select **Version**, and ensure that the correct version appears.

1. Select **ifconfig** to displays the parameters for the appliance's physical interfaces.

## Activate the on-premises management console

In order to set up your management console, you will need to sign in, and activate it.

**To sign in to the management console:**

1. Navigate to the IP address you received for the on-premises management console during the system installation.

1. Enter the username and password you received for the on-premises management console during the system installation.

After you sign in for the first time, you will need to activate the on-premises management console by getting, and uploading an activation file.

**To activate the on-premises management console:**

1. Select the **Take Action** link, in the alert notification at the top of the screen.

   :::image type="content" source="media/how-to-manage-sensors-from-the-on-premises-management-console/take-action.png" alt-text="Select the Take Action link from the alert on the top of the screen.":::

1. In the Activation popup screen, select the **Azure portal** link.

   :::image type="content" source="media/how-to-manage-sensors-from-the-on-premises-management-console/azure-portal.png" alt-text="Select the Azure portal link from the popup message.":::

1. Select a subscription to associate the on-premises management console to, and then select the **Download on-premises management console activation file** button. The activation file is downloaded.

   The on-premises management console can be associated to one, or more subscriptions. The activation file will be associated with all of the selected subscriptions, and the number of committed devices at the time of download.

   :::image type="content" source="media/how-to-manage-sensors-from-the-on-premises-management-console/multiple-subscriptions.png" alt-text="You can select multiple subscriptions to onboard your on-premises management console to.":::

1. Navigate back to the **Activation** popup screen, and select **Choose File**.

1. Select the downloaded file.

> [!Note]
> Valuation environments will use the self signed certificate. Production environments should not use the self signed certificate.

