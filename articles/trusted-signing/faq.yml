### YamlMime:FAQ
metadata:
  title: Frequently asked questions #Required; The page title is displayed in search results. Include "FAQ" or "Frequently asked questions".
  description: FAQ for Trusted Signing #Required; Article description that's displayed in search results. Use 100 to 160 characters. Include "FAQ" or "Frequently asked questions".
  author: microsoftshawarma #Required; your GitHub user alias, with correct capitalization.
  ms.author: rakiasegev #Required; microsoft alias of author; optional team alias.
  ms.service: azure-code-signing #Required; service per approved list. slug assigned by ACOM.
  ms.topic: faq #Required
  ms.date: 02/15/2024 #Required; mm/dd/yyyy format.
title: Trusted Signing #Required. This appears as the headline in the article as displayed.
summary: |
  This article includes FAQ about Trusted Signing. 

# Remove all the comments in this template before you sign-off or merge to the main branch.

# Remember that indentation is significant in YAML files.
# If there is any disallowed spacing, the build will fail.

sections:
  - name: Onboarding
    questions:
      - question: What Windows versions does Trusted Signing support? # Question.
        answer: | 
          The following [link](https://support.microsoft.com/en-us/topic/kb5022661-windows-support-for-the-azure-code-signing-program-4b505a31-fa1e-4ea6-85dd-6630229e8ef4) outlines in detail Windows support for Azure Code Signing,
          with the service supported on all currently supported versions of:  
          *Windows 11 (Supported out of the box) 
          *Windows 10 - RS5 (Windows 10, Version 1809/ October 2018 Update) or newer 
          *Windows Server 2019, Windows Server 2016  
          Files signed by Azure Code Signing’s Public Trust certificates are trusted on:  
          *Windows Server 2012 R2 (Command line only) 
          *Windows 8.1 
          *Windows 7 SP1 ESU - Must install May 2021 update rolls up  
          *Windows 10 1507  
          Not Supported 
          *Windows 7 SP1 non-ESU (Not supported by Microsoft) 
          *Windows OS version that were already end of life

          General User Mode Code Integrity (UMCI) support for Trusted Signing signed binaries was added in the July 2021 CTL update delivered by Windows Update. In standard scenarios, the system will pull down the root CA cert into the trust root store on a system upon first sight of a end-entity cert from that chain on the machine. 
      - question: How do I grant API access in Azure AD to Trusted Signing?
        answer: | 
          You will need to ask your tenant admin to provide you with an approval. Below are a few helpful links: 
          *[Overview of consent and permissions - Azure AD | Microsoft Docs](https://learn.microsoft.com/en-us/entra/identity/enterprise-apps/user-admin-consent-overview)
          *[Configure the admin consent workflow - Azure AD | Microsoft Docs](https://learn.microsoft.com/en-us/entra/identity/enterprise-apps/configure-admin-consent-workflow)
          Also, the following link on app permissions may be of help [Review permissions granted to applications - Azure AD | Microsoft Docs](https://learn.microsoft.com/en-us/entra/identity/enterprise-apps/manage-application-permissions?pivots=portal)
      - question: What do I do if I don’t see Microsoft.CodeSigning in my resource provider? 
        answer: | 
          Register the app Microsoft.CodeSigning in the subscription resource provider page. The screenshot below outlines how to do so in the Azure Portal: ![Screenshot of registering Microsoft.CodeSigning resource provider](articles\trusted-signing\media\trusted-signing-resource-provider.png)

  - name: Certificate Profiles
    questions:
      - question: What is Azure Code Signing’s compliance level?
        answer: |
          FIPS 140-2 level 3 (mHSMs)

  - name: Signing
    questions:
      - question: What is Trusted Signing’s compliance level?
        answer: |
          FIPS 140-2 level 3 (mHSMs)
      - question: INTEGRITYCHECK How to include the appropriate EKU for our certificates into the ELAM driver resources? 
        answer: |
          For those folks looking at their ELAM driver config for Protected Anti-Malware Services, please refer to this guidance "Beginning in 2022, all user mode anti-malware service binaries must be signed by Microsoft's Azure Code Sign signing service. The Azure Code Sign issued Authenticode certificate for signing anti-malware binaries is updated every 30 days for security. To prevent the need to update the ELAM driver every time the certificate is updated, we recommend that anti-malware vendors include the Azure Code Sign PCA certificate TBS hash in the CertHash portion of the ELAM driver resource file info. Additionally, the anti-malware vendor must include their unique ACS EKU identity in the EKU field of the resource file info. The EKU identity will begin with the prefix "1.3.6.1.4.1.311.97."."
          The Microsoft ID Verified Code Signing PCA 2021 cert is [here](http://www.microsoft.com/pkiops/certs/microsoft id verified code signing pca 2021.crt).
      - question: INTEGRITYCHECK What happens if we run the binaries which are Trusted Signing signed on a machine which does not have the ACS update, especially binaries which are INTEGRITYCHECK-ed?
        answer: |
          They will not be able to have their signature validated at runtime and not run with INTEGRITYCHECK or user will be prompted with a warning if no INTEGRITYCHECK flag is set. 
          Each B security release is cumulative, so ideally let's say with April 2022's updates, support for ACS signature should be taken care of. However, to get each specific update for each OS version, we will need some more time to get back since we need to reach out to our extended teams. But assuming if you have any updates after October 2021, you should be good.  
          To check if ACS update is installed or not: We recommend checking against one of your packaged /IntegrityCheck-linked DLLs, dummy one will work too. That way your check can be done independently of the platform and the availability of our IntegrityCheck-linked binaries. 
      - question: INTEGRITYCHECK My Sectigo cert is expiring, can I get a new one or do I have to use Trusted Signing?
        answer: |
          The official guidance is we not extending any cross-signed certificates. If you need /INTEGRITYCHECK you must sign with the Trusted Signing service.
      - question: How is Trusted Signing different than the signing customers do with Partner Center?
        answer: |
          Signing with Partner Center is Kernel mode signing (no change here with the introduction of Trusted Signing), you will need to sign you user mode binaries with Trusted Signing. For your apps that interact with the Windows Security Center (WSC) service, must include the Code Integrity bit (/INTEGRITYCHECK).  Without the Trusted Signing signature, you won’t be able to register with the WSC and Windows Defender will run in parallel.
      - question: How do we get the Authenticode certificate?  
        answer: |
          The Authenticode certificate used for signing with the profile is never given to you. All certificates are securely stored within the service and are only accessible at the time of signing. The public certificate will always be included in any signed binary by the service. 

      - question: What are the common things I should check when I get a SignTool error (e.g. unexpected internal error has occurred)? 
        answer: |
         *Double check: dlib and dll are in the correct path 
         *Also, double check that sign tool and dlib are both 64 bit 
         *Install C++ Redistributables: Download link: https://docs.microsoft.com/en-us/cpp/windows/latest-supported-vc-redist?view=msvc-170 
         *Search the specific issue on Bing or visit [SignTool - Win32 apps | Microsoft Docs](https://docs.microsoft.com/en-us/windows/win32/seccrypto/signtool) 
         *Also, we recommend using the SignTool version here: https://developer.microsoft.com/en-us/windows/downloads/windows-sdk/ as opposed to directly from NuGet. The link above is what we have tested to work with our dlib (version 10.0.22621 recommended currently). 

additionalContent: |
    ## Next steps