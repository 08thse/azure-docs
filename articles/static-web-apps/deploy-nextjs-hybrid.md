---
title: "Tutorial: Deploy hybrid Next.js websites on Azure Static Web Apps"
description: "Generate and deploy Next.js hybrid sites with Azure Static Web Apps."
services: static-web-apps
author: aaronpowell
ms.service: static-web-apps
ms.topic:  tutorial
ms.date: 10/12/2022
ms.author: aapowell
ms.custom: devx-track-js
---


# Deploy hybrid Next.js websites on Azure Static Web Apps (Preview)

In this tutorial, you learn to deploy a [Next.js](https://nextjs.org) website to [Azure Static Web Apps](overview.md), leveraging the support for Next.js features such as React Server Components, Server-Side Rendering (SSR) and API routes.

>[!NOTE]
> Next.js hybrid support is in preview.

## Prerequisites

- An Azure account with an active subscription. [Create an account for free](https://azure.microsoft.com/free/).
- A GitHub account. [Create an account for free](https://github.com/join).
- [Node.js](https://nodejs.org) installed.
- [Next.js CLI](https://nextjs.org/docs/getting-started) installed. Refer to the [Next.js Getting Started guide](https://nextjs.org/docs/getting-started) for details.

[!INCLUDE [Unsupported Next.js features](../../includes/static-web-apps-nextjs-unsupported.md)]

## Create a repository

This article uses a GitHub template repository to make it easy for you to get started. The template features a starter app to deploy to Azure Static Web Apps.

1. Navigate to the following location to create a new repository:

    [https://github.com/staticwebdev/nextjs-hybrid-starter/generate](https://github.com/login?return_to=%2Fstaticwebdev%2Fnextjs-hybrid-starter%2Fgenerate)

1. Name your repository **my-first-static-web-app**

1. Select **Create repository from template**.

    :::image type="content" source="media/getting-started/create-template.png" alt-text="Screenshot of create repository from template button.":::

## Create a static web app

[!INCLUDE [create steps](../../includes/static-web-apps/static-web-apps-tutorials-portal-create.md)]

In the _Build Details_ section, add configuration details specific to your preferred front-end framework.

1. Select **Next.js** from the _Build Presets_ dropdown.

1. Keep the default value in the _App location_ box.

1. Leave the _Api location_ box empty.

1. Leave the _App artifact location_ box empty.

Select **Review + create**.

:::image type="content" source="media/getting-started-portal/review-create.png" alt-text="Screenshot of the create button.":::

## View the website

[!INCLUDE [view website](../../includes/static-web-apps/static-web-apps-tutorials-portal-view-website.md)]

## Add Server-Rendered data with a Server Component

To add server-rendered data in your Next.js project using the App Router, edit a Next.js component to add a server-side operations and render these in this component. By default, Next.js components are [Server Components](https://nextjs.org/docs/app/building-your-application/data-fetching/fetching-caching-and-revalidating) that can be server-rendered.

1. Open the _pages/index.ts_ file and add an exported function named `getServerSideProps`.

    ```ts
    export async function getServerSideProps() {
        const data = JSON.stringify({ time: new Date() });
        return { props: { data } };
    }
    ```

1. Update the `Home` component to receive the server-rendered data.

    ```ts
    export default function Home({ data }: { data: { time: string } }) {
        const serverData = JSON.parse(data);

        return (
            <div className={styles.container}>
                <Head>
                    <title>Create Next App</title>
                    <meta name="description" content="Generated by create next app" />
                    <link rel="icon" href="/favicon.ico" />
                </Head>

                <main className={styles.main}>
                    <h1 className={styles.title}>
                        Welcome to <a href="https://nextjs.org">Next.js! The time is {serverData.time}</a>
                    </h1>
                // snip
    ```

1. Commit and push the changes.

Once the changes are pushed, a new GitHub Actions workflow begins and the changes are deployed to your site.

## Adding an API route

Next.js has [API routes](https://nextjs.org/docs/api-routes/introduction) which is an alternative to Azure Functions for creating APIs for the Next.js client application.

Begin by adding an API route.

1. Create a new file at _pages/api/time.ts_.
1. Add a handler function to return data from the API.

    ```ts
    import type { NextApiRequest, NextApiResponse } from "next";

    export default async function handler(req: NextApiRequest, res: NextApiResponse) {
        res.status(200).json({ time: new Date() });
    }
    ```

1. Open _pages/index.ts_ to add a call to the API, and display the result.

    ```ts
    export default function Home({ data }: { data: { time: string } }) {
        const [time, setTime] = useState<Date | null>(null);
        useEffect(() => {
            fetch('/api/time')
            .then(res => res.json())
            .then(json => setTime(new Date(json.time)));
        }, []);
        return (
            <div className={styles.container}>
                <Head>
                    <title>Create Next App</title>
                    <meta name="description" content="Generated by create next app" />
                    <link rel="icon" href="/favicon.ico" />
                </Head>

                <main className={styles.main}>
                    <h1 className={styles.title}>
                    Welcome to{" "}
                    <a href="https://nextjs.org">
                        Next.js!{" "}
                        {time &&
                        `The time is ${time.getHours()}:${time.getMinutes()}:${time.getSeconds()}`}
                    </a>
                    </h1>
                    // snip
    }
    ```

1. The result from the API route will be displayed on the page.

:::image type="content" source="media/deploy-nextjs/nextjs-api-route-display.png" alt-text="Display the output from the API route":::

## Enable logging for Next.js

Following best practices for Next.js server API troubleshooting, add logging to the API to catch these errors. Logging on Azure uses **Application Insights**. In order to preload this SDK, you need to create a custom start up script. To learn more:

* [Example preload script for Application Insights + Next.js](https://medium.com/microsoftazure/enabling-the-node-js-application-insights-sdk-in-next-js-746762d92507)
* [GitHub issue](https://github.com/microsoft/ApplicationInsights-node.js/issues/808)
* [Preloading with Next.js](https://jake.tl/notes/2021-04-04-nextjs-preload-hack)

## Clean up resources

[!INCLUDE [clean up](../../includes/static-web-apps/static-web-apps-tutorials-portal-clean-up.md)]

## Next steps

> [!div class="nextstepaction"]
> [Configure app settings](./application-settings.md)
