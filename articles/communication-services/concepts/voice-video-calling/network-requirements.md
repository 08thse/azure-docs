---
title: Prepare your organization's network for Azure Communication Services
titleSuffix: An Azure Communication Services concept document
description: Learn aboUnderstand the network requirements for Azure Commumnication Service Voice and Video Calling
author: mikben
manager: jken
services: azure-communication-services

ms.author: nmurav
ms.date: 3/14/2021
ms.topic: overview
ms.service: azure-communication-services
---


# Planning for Media Quality in Azure Communication Services

This article explains the factors that affects the media quality and provides the guidance how to monitor your solution to ensure the best possible quality.

## Factors that affect media quality and reliability

There are many different factors that contribute to Azure Communication Services  Real-Time media (audio, video, and application sharing) quality that include the devices that are used, the environment, and the network connectivity.


### Network quality

The quality of the Real-Time media over IP network is greatly impacted by the quality of the network connectivity, but especially by the amount of:
* **Latency**. This is the time it takes to get an IP packet from point A to point B on the network. This network propagation delay is essentially tied to physical distance between the two points and the speed of light, including additional overhead taken by the various routers in between. Latency is measured as one-way or Round-trip Time (RTT).
* **Packet Loss**. A percentage of packets that are lost in a given window of time. Packet loss directly affects audio qualityâ€”from small, individual lost packets having almost no impact, to back-to-back burst losses that cause complete audio cut-out.
* **Inter-packet arrival jitter or simply jitter**. This is the average change in delay between successive packets. Azure Communication Services  can adapt to some levels of jitter through buffering. It's only when the jitter exceeds the buffering that a participant will notice the effects of jitter.

### Network bandwidth

With many concurrent Azure Communication Services media sessions, as well as other network traffic generated by other services and business applications, making sure that there is sufficient bandwidth over the entire network path that connects your network to the Azure Communication Services is critical to avoid network congestion and ensure excellent media Real-Time media (audio, video, and application sharing) quality.

_Bandwidth requirements for Azure Communication Services _


### Firewall (s) configuration.

The Azure Communication Services connection requires internet connectivity to specific ports to transmit traffic with high-quality. Azure Communication Services can work if access to all the necessary IP addresses, ports are not open. However, the optimal experience is provided when recommended ports and IP ranges are open.

| Category | IP ranges or FQDN | Ports | 
| :-- | :-- | :-- |
| Media traffic | [Range of Azure Public Cloud IP Addresses](https://www.microsoft.com/en-us/download/confirmation.aspx?id=56519) | UDP 3478 through 3481, TCP ports 443 |
| Signalling, telemetry, registration| *.skype.com, *.microsoft.com. *.azure.net, *.azureedge.net | TCP 443, 80 |

### Network optimization

The following tasks are optional and aren't required for rolling out Azure Communication Services. Use this guidance to optimize your network and Azure Communication Services performance or if you know you've got some network limitations.
You might want to do additional network optimization if:
* Azure Communication Services runs slowly (maybe you have insufficient bandwidth)
* Calls keep dropping (might be due to firewall or proxy blockers)
* Calls have static and cut out, or voices sound like robots (could be jitter or packet loss)


| Network optimization task | Details |
| :-- | :-- |
| Plan your network | In this documentation you can find minimal requirements to your network for calls. You can consult [Teams example for planning your network](https://docs.microsoft.com/en-us/microsoftteams/tutorial-network-planner-example) |
| External name resolution | Be sure that all computers running the Azure Communications Services SDKs can resolve external DNS queries to discover the services provided by Azure Communication Servicers and that your firewalls are not preventing access. Please ensure that the SDKs can resove addresses *.skype.com, *.microsoft.com. *.azure.net, *.azureedge.net  |
| Maintain session persistence | Make sure your firewall doesn't change the mapped Network Address Translation (NAT) addresses or ports for UDP
Validate NAT pool size | Validate the network address translation (NAT) pool size required for user connectivity. When multiple users and devices access Azure Communication Services  using [Network Address Translation (NAT) or Port Address Translation (PAT)](https://docs.microsoft.com/en-us/office365/enterprise/nat-support-with-office-365), you need to ensure that the devices hidden behind each publicly routable IP address do not exceed the supported number. Ensure that adequate public IP addresses are assigned to the NAT pools to prevent port exhaustion. Port exhaustion will contribute to internal users and devices being unable to connect to the Azure Communication Services |
| Intrusion Detection and Prevention Guidance | If your environment has an [Intrusion Detection](https://docs.microsoft.com/en-us/azure/network-watcher/network-watcher-intrusion-detection-open-source-tools) or Prevention System (IDS/IPS) deployed for an extra layer of security for outbound connections, be sure to allow all Azure Communication Services URLs |
| Configure split-tunnel VPN | We recommend that you provide an alternate path for Teams traffic that bypasses the virtual private network (VPN), commonly known as [split-tunnel VPN](https://docs.microsoft.com/en-us/windows/security/identity-protection/vpn/vpn-routing). Split tunneling means that traffic for Azure Communications Services  doesn't go through the VPN but instead goes directly to Azure. Bypassing your VPN will have a positive impact on  media quality, and it reduces load from the VPN devices and the organization's network. To implement a split-tunnel VPN, work with your VPN vendor. Other reasons why we recommend bypassing the VPN: <ul><li> VPNs are typically not designed or configured to support real-time media.</li><li> VPNs might also not support UDP (which is required for Azure Communication Services)</li><li>VPNs also introduce an extra layer of encryption on top of media traffic that's already encrypted.</li><li>Connectivity to Azure Communication Services might not be efficient due to hair-pinning traffic through a VPN device.</li></ul>
| Implement QoS | [Use Quality of Service (QoS)](https://docs.microsoft.com/en-us/microsoftteams/qos-in-teams) to configure packet prioritization. This will improve call quality and help you monitor and troubleshoot call quality. QoS should be implemented on all segments of a managed network. Even when a network has been adequately provisioned for bandwidth, QoS provides risk mitigation in the event of unanticipated network events. With QoS, voice traffic is prioritized so that these unanticipated events don't negatively affect quality. | 
| Optimize WiFi | Similar to VPN, WiFi networks aren't necessarily designed or configured to support real-time media. Planning for, or optimizing, a WiFi network to support Azure Communication Services is an important consideration for a high-quality deployment. Consider these factors: <ul><li>Implement QoS or WiFi Multimedia (WMM) to ensure that media traffic is getting prioritized appropriately over your WiFi networks.</li><li>Plan and optimize the WiFi bands and access point placement. The 2.4 GHz range might provide an adequate experience depending on access point placement, but access points are often affected by other consumer devices that operate in that range. The 5 GHz range is better suited to real-time media due to its dense range, but it requires more access points to get sufficient coverage. Endpoints also need to support that range and be configured to leverage those bands accordingly.</li><li>If you're using dual-band WiFi networks, consider implementing band steering. Band steering is a technique implemented by WiFi vendors to influence dual-band clients to use the 5 GHz range.</li><li>When access points of the same channel are too close together, they can cause signal overlap and unintentionally compete, resulting in a bad experience for the user. Ensure that access points that are next to each other are on channels that don't overlap.</li></ul> Each wireless vendor has its own recommendations for deploying its wireless solution. Consult your WiFi vendor for specific guidance.



### Operation system and Browsers (for Java Script SDKs)

Azure Communication Services Voice/Video SDKs supports the selected versions of the Operation Systems and Browsers (for JavaScript SDK). The limitations are caused by the operating systems and/or browser architecture. E.g., Safari on IOS before version 14.5 cannot switch Bluetooth devices. Ensuring that users are on the supported version of OS and browsers guarantees the optimal quality of experience. 
[Lean about supported versions of the OS and Browsers for Azure Communication Services SDKs](https://docs.microsoft.com/en-us/azure/communication-services/concepts/voice-video-calling/calling-sdk-features)



