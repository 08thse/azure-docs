---
author: memildin
ms.service: security-center
ms.topic: include
ms.date: 09/30/2020
ms.author: memildin
ms.custom: generated
---

|Recommendation |Description |Severity |
|---|---|---|
|Advanced data security should be enabled on your managed instances |Advanced data security (ADS) is a unified package that provides advanced SQL security capabilities. It discovers and classifies sensitive data, surfaces and mitigates potential database vulnerabilities, and detects anomalous activities that could indicate a threat to your database. ADS is charged at $15 per managed SQL server.<br />(Related policy: [Advanced data security should be enabled on SQL Managed Instance](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2fabfb7388-5bf4-4ad7-ba99-2cd2f41cebb9)) |High |
|Advanced data security should be enabled on your SQL servers |Advanced data security (ADS) is a unified package that provides advanced SQL security capabilities. It discovers and classifies sensitive data, surfaces and mitigates potential database vulnerabilities, and detects anomalous activities that could indicate a threat to your database. ADS is charged at $15 per SQL server.<br />(Related policy: [Advanced data security should be enabled on your SQL servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fmicrosoft.authorization%2fpolicydefinitions%2fabfb4388-5bf4-4ad7-ba82-2cd2f41ceae9)) |High |
|All advanced threat protection types should be enabled in SQL managed instance advanced data security settings |It is recommended to enable all advanced threat protection types on your SQL managed instances. Enabling all types protects against SQL injection, database vulnerabilities, and any other anomalous activities.<br />(No related policy) |Medium |
|All advanced threat protection types should be enabled in SQL server advanced data security settings |It is recommended to enable all advanced threat protection types on your SQL servers. Enabling all types protects against SQL injection, database vulnerabilities, and any other anomalous activities.<br />(No related policy) |Medium |
|An Azure Active Directory administrator should be provisioned for SQL servers |Provision an Azure AD administrator for your SQL server to enable Azure AD authentication. Azure AD authentication enables simplified permission management and centralized identity management of database users and other Microsoft services.<br />(Related policy: [An Azure Active Directory administrator should be provisioned for SQL servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f1f314764-cb73-4fc9-b863-8eca98ac36e9)) |High |
|Auditing on SQL server should be enabled |Enable auditing on your SQL Server to track database activities across all databases on the server and save them in an audit log.<br />(Related policy: [Auditing on SQL server should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2fa6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9)) |Low |
|Azure Defender for Azure SQL Database servers should be enabled |Azure Defender for SQL is a unified package that provides advanced SQL security capabilities.<br>It includes functionality for surfacing and mitigating potential database vulnerabilities, detecting anomalous activities that could indicate a threat to your database, and discovering and classifying sensitive data.<br><br>Important: Remediating this recommendation will result in charges for protecting your Azure SQL Database servers. If you don't have any Azure SQL Database servers in this subscription, no charges will be incurred.<br>If you create any Azure SQL Database servers on this subscription in the future, they will automatically be protected and charges will begin at that time.<br> <a href='https://docs.microsoft.com/azure/azure-sql/database/advanced-data-security'>Learn more about Azure Defender for Azure SQL Database servers.</a><br />(Related policy: [Advanced data security should be enabled on Azure SQL Database servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fmicrosoft.authorization%2fpolicyDefinitions%2f7fe3b40f-802b-4cdd-8bd4-fd799c948cc2)) |High |
|Azure Defender for SQL servers on machines should be enabled |Azure Defender for SQL is a unified package that provides advanced SQL security capabilities.<br>It includes functionality for surfacing and mitigating potential database vulnerabilities, detecting anomalous activities that could indicate a threat to your database, and discovering and classifying sensitive data.<br><br>Important: Remediating this recommendation will result in charges for protecting your SQL servers on machines. If you don't have any SQL servers on machines in this subscription, no charges will be incurred.<br>If you create any SQL servers on machines on this subscription in the future, they will automatically be protected and charges will begin at that time.<br> <a href='https://docs.microsoft.com/azure/azure-sql/database/advanced-data-security'>Learn more about Azure Defender for SQL servers on machines.</a><br />(Related policy: [Advanced data security should be enabled on SQL servers on machines](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fmicrosoft.authorization%2fpolicyDefinitions%2f6581d072-105e-4418-827f-bd446d56421b)) |High |
|Azure Defender for Storage should be enabled |Azure Defender for storage detects unusual and potentially harmful attempts to access or exploit storage accounts.<br><br>Important: Remediating this recommendation will result in charges for protecting your Azure Storage accounts. If you don't have any Azure Storage accounts in this subscription, no charges will be incurred.<br>If you create any Azure Storage accounts on this subscription in the future, they will automatically be protected and charges will begin at that time.<br> <a href='https://docs.microsoft.com/azure/storage/common/storage-advanced-threat-protection'>Learn more about Azure Defender for Storage</a><br />(Related policy: [Advanced threat protection should be enabled on Azure Storage accounts](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fmicrosoft.authorization%2fpolicyDefinitions%2f308fbb08-4ab8-4e67-9b29-592e93fb94fa)) |High |
|Diagnostic logs in Azure Data Lake Store should be enabled |Enable logs and retain them up to a year. This enables you to recreate activity trails for investigation purposes when a security incident occurs or your network is compromised.<br />(Related policy: [Diagnostic logs in Azure Data Lake Store should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f057ef27e-665e-4328-8ea3-04b3122bd9fb)) |Low |
|Diagnostic logs in Data Lake Analytics should be enabled |Enable logs and retain them up to a year. This enables you to recreate activity trails for investigation purposes when a security incident occurs or your network is compromised.<br />(Related policy: [Diagnostic logs in Data Lake Analytics should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2fc95c74d9-38fe-4f0d-af86-0c7d626a315c)) |Low |
|Ensure a log metric filter and alarm exist for S3 bucket policy changes |By directing CloudTrail Logs to CloudWatch Logs real-time monitoring of API calls can be achieved. Metric filter and alarm should be established for changes to S3 bucket policies.<br />(No related policy) |Medium |
|Ensure CloudTrail logs are encrypted at rest using AWS KMS CMKs |CloudTrail logs should be configured to leverage server side encryption (SSE) and KMS customer created master keys (CMK) to further protect CloudTrail logs.<br />(No related policy) |Medium |
|Ensure S3 bucket access logging is enabled on the CloudTrail S3 bucket |S3 Bucket Access Logging generates a log that contains access records for each request made to your S3 bucket and could be used for  security analysis, resource change tracking, and compliance auditing.<br />(No related policy) |Low |
|Ensure that BigQuery datasets are not anonymously or publicly accessible |To ensure that sensitive data is not compromised, IAM policies on BigQuery datasets must not allow anonymous or public access.<br />(No related policy) |High |
|Ensure that Cloud SQL database instances are configured with automated backups |Cloud SQL database instances must be configured with automated backups.<br />(No related policy) |High |
|Ensure that Cloud SQL database instances are not open to the world |Cloud SQL instances must be configured to only accept connections from trustworthy networks and/or IP addresses and restrict all other access. <br />(No related policy) |High |
|Ensure that Cloud SQL database instances do not have public IPs |Cloud SQL instances must be configured to use private IP addresses, and not public IP addresses.<br />(No related policy) |High |
|Ensure that Cloud Storage bucket is not anonymously or publicly accessible |Ensure that an IAM policy on Cloud Storage buckets does not allow anonymous or public access so sensitive data.<br />(No related policy) |High |
|Ensure that Cloud Storage buckets have uniform bucket-level access enabled |For simple and unifed resource access, ensure that Cloud Storage buckets have uniform bucket-level access enabled.<br />(No related policy) |Medium |
|Ensure that the Cloud SQL database instance requires all incoming connections to use SSL |Ensure that the Cloud SQL Database instance requires all incoming connections to always use SSL encryption.<br />(No related policy) |High |
|Ensure that the log metric filter and alerts exist for Cloud Storage IAM permission changes |"Ensure that the log metric filter and alerts are configured for Cloud Storage IAM permission changes. Monitoring changes to a storage bucket permissions can help identify malicious attempts to access a sensitive storage buckets and objects inside buckets.<br />(No related policy) |Low |
|Ensure that the log metric filter and alerts exist for SQL instance configuration changes |Ensure that the log metric filter and alerts are configured for SQL instance configuration changes. Monitoring changes to an SQL instance can help identify malicious attempts to access a sensitive data stored in an SQL instance. <br />(No related policy) |Low |
|Ensure the S3 bucket CloudTrail logs to is not publicly accessible |Enabling public access to CloudTrail log content could assist an adversary in identifying weaknesses in the affected account's use or configuration.<br />(No related policy) |High |
|Only secure connections to your Redis Cache should be enabled |Enable only connections via SSL to Redis Cache. Use of secure connections ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking.<br />(Related policy: [Only secure connections to your Azure Cache for Redis should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f22bee202-a82f-4305-9a2a-6d7f44d4dedb)) |High |
|Sensitive data in your SQL databases should be classified |Azure SQL DB Data discovery & classification provides capabilities for discovering, classifying, labeling, and protecting the sensitive data in your databases. Once your data is classified, you can use Azure SQL DB auditing to audit access and monitor the sensitive data. Azure SQL DB also enables Advanced Threat Protection features which creates intelligent alerts based on changes in the access patterns to the sensitive data.<br />(Related policy: [Sensitive data in your SQL databases should be classified](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fmicrosoft.authorization%2fpolicydefinitions%2fcc9835f2-9f6b-4cc8-ab4a-f8ef615eb349)) |High |
|Storage accounts should be migrated to new Azure Resource Manager resources |To benefit from new capabilities in Azure Resource Manager, you can migrate existing deployments from the Classic deployment model. Resource Manager enables security enhancements such as: stronger access control (RBAC), better auditing, ARM-based deployment and governance, access to managed identities, access to key vault for secrets, Azure AD-based authentication and support for tags and resource groups for easier security management. <a target='_blank' href='https://docs.microsoft.com/en-us/azure/virtual-machines/windows/migration-classic-resource-manager-overview'>Learn more</a><br />(Related policy: [Storage accounts should be migrated to new Azure Resource Manager resources](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f37e0d2fe-28a5-43d6-a273-67d37d1f5606)) |Low |
|Transparent Data Encryption on SQL databases should be enabled |Enable transparent data encryption to protect data-at-rest and meet compliance requirements<br />(Related policy: [Transparent Data Encryption on SQL databases should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f17k78e20-9358-41c9-923c-fb736d382a12)) |Low |
|Vulnerability assessment findings on your SQL databases should be remediated |SQL Vulnerability Assessment scans your database for security vulnerabilities, and exposes any deviations from best practices such as misconfigurations, excessive permissions, and unprotected sensitive data. Resolving the vulnerabilities found can greatly improve your database security posture.<br />(Related policy: [Vulnerabilities on your SQL databases should be remediated](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fmicrosoft.authorization%2fpolicydefinitions%2ffeedbf84-6b99-488c-acc2-71c829aa5ffc)) |High |
|Vulnerability assessment findings on your SQL servers on machines should be remediated |SQL Vulnerability Assessment scans your database for security vulnerabilities, and exposes any deviations from best practices such as misconfigurations, excessive permissions, and unprotected sensitive data. Resolving the vulnerabilities found can greatly improve your database security posture.<br />(No related policy) |High |
|Vulnerability assessment should be enabled on your SQL managed instances |Vulnerability assessment can discover, track, and help you remediate potential database vulnerabilities.<br />(Related policy: [Vulnerability assessment should be enabled on SQL Managed Instance](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f1b7aa243-30e4-4c9e-bca8-d0d3022b634a)) |High |
|Vulnerability assessment should be enabled on your SQL servers |Vulnerability assessment can discover, track, and help you remediate potential database vulnerabilities.<br />(Related policy: [Vulnerability assessment should be enabled on your SQL servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2fef2a8f2a-b3d9-49cd-a8a8-9a3aaaf647d9)) |High |
