---
author: memildin
ms.service: defender-for-cloud
ms.topic: include
ms.date: 11/29/2021
ms.author: memildin
ms.custom: generated
---

There are **27** AWS recommendations in this category.

|Recommendation |Description |Severity |
|---|---|---|
|[All EC2 instances managed by Systems Manager should be compliant with patching requirements](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/11c3f3c8-3c13-48be-9ee5-67b6865e7462) |This control checks whether the compliance status of the Amazon EC2 Systems Manager patch compliance is COMPLIANT or NON_COMPLIANT after the patch installation on the instance. It only checks instances that are managed by Systems Manager Patch Manager. Having your EC2 instances fully patched as required by your organization reduces the attack surface of your AWS accounts. |Medium |
|[Amazon EFS should be configured to encrypt file data at rest using AWS KMS](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/4e482075-311f-401e-adc7-f8a8affc5635) |This control checks whether Amazon Elastic File System is configured to encrypt the file data using AWS KMS. The check fails in the following cases: <br> *"Encrypted" is set to "false" in the <a href='https://docs.aws.amazon.com/efs/latest/ug/API_DescribeFileSystems.html'>DescribeFileSystems</a> response. <br> The "KmsKeyId" key in the <a href='https://docs.aws.amazon.com/efs/latest/ug/API_DescribeFileSystems.html'>DescribeFileSystems</a> response does not match the KmsKeyId parameter for <a href='https://docs.aws.amazon.com/config/latest/developerguide/efs-encrypted-check.html'>efs-encrypted-check</a>. <br> Note that this control does not use the "KmsKeyId" parameter for <a href='https://docs.aws.amazon.com/config/latest/developerguide/efs-encrypted-check.html'>efs-encrypted-check</a>. It only checks the value of "Encrypted". For an added layer of security for your sensitive data in Amazon EFS, you should create encrypted file systems. <br> Amazon EFS supports encryption for file systems at-rest. You can enable encryption of data at rest when you create an Amazon EFS file system. <br> To learn more about Amazon EFS encryption, see <a href='https://docs.aws.amazon.com/efs/latest/ug/encryption.html'>Data encryption in Amazon EFS</a> in the Amazon Elastic File System User Guide. |Medium |
|[Amazon EFS volumes should be in backup plans](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/e864e460-158b-4a4a-beb9-16ebc25c1240) |This control checks whether Amazon Elastic File System (Amazon EFS) file systems are added to the backup plans in AWS Backup. The control fails if Amazon EFS file systems are not included in the backup plans. <br> Including EFS file systems in the backup plans helps you to protect your data from deletion and data loss. |Medium |
|[Application Load Balancer deletion protection should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/fbec0eb1-0e7e-4df0-8f3c-bf9ac1601927) |This control checks whether an Application Load Balancer has deletion protection enabled. The control fails if deletion protection is not configured. Enable deletion protection to protect your Application Load Balancer from deletion. |Medium |
|[Application Load Balancer deletion protection should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/5c508bf1-26f9-4696-bb61-8341d395e3de) |This control checks whether an Application Load Balancer has deletion protection enabled. The control fails if deletion protection is not configured. <br>Enable deletion protection to protect your Application Load Balancer from deletion. |Medium |
|[Auto Scaling groups associated with a load balancer should use health checks](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/837d6a45-503f-4c95-bf42-323763960b62) |Auto Scaling groups that are associated with a load balancer are using Elastic Load Balancing health checks. <br> PCI DSS does not require load balancing or highly available configurations. This is recommended by AWS best practices. |Low |
|[Auto scaling groups associated with a load balancer should use health checks](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/94d42d13-40a6-47df-b16e-be141aae83c3) |This control checks whether your Auto Scaling groups that are associated with a load balancer are using Elastic Load Balancing health checks. PCI DSS does not require load balancing or highly available configurations. However, this check aligns with AWS best practices. |Low |
|[Aws accounts should have Azure Arc auto provisioning enabled](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/882a80f0-943f-473e-b6d7-40c7a625540e) |For full visibility of the security content from Microsoft Defender for servers, EC2 instances should be connected to Azure Arc. To ensure that all eligible EC2 instances automatically receive Azure Arc, enable auto-provisioning from Defender for Cloud at the AWS account level. Learn more about <a href='/azure/azure-arc/servers/overview'>Azure Arc</a>, and <a href='/azure/security-center/defender-for-servers-introduction'>Microsoft Defender for Servers</a>. |High |
|[CloudFront distributions should have origin failover configured](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/4779e962-2ea3-4126-aa76-379ea271887c) |This control checks whether an Amazon CloudFront distribution is configured with an origin group that has two or more origins.<br>CloudFront origin failover can increase availability. Origin failover automatically redirects traffic to a secondary origin if the primary origin is unavailable or if it returns specific HTTP response status codes. |Medium |
|[CloudFront distributions should have origin failover configured](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/7196e4f7-7136-4003-b3e5-a8156d160a3f) |This control checks whether an Amazon CloudFront distribution is configured with an origin group that has two or more origins. CloudFront origin failover can increase availability. Origin failover automatically redirects traffic to a secondary origin if the primary origin is unavailable or if it returns specific HTTP response status codes. |Low |
|[CodeBuild GitHub or Bitbucket source repository URLs should use OAuth](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/9694d4ef-f21a-40b7-b535-618ac5c5d21e) |This control checks whether the GitHub or Bitbucket source repository URL contains either personal access tokens or a user name and password.<br>Authentication credentials should never be stored or transmitted in clear text or appear in the repository URL. Instead of personal access tokens or user name and password, you should use OAuth to grant authorization for accessing GitHub or Bitbucket repositories.<br> Using personal access tokens or a user name and password could expose your credentials to unintended data exposure and unauthorized access. |High |
|[CodeBuild project environment variables should not contain credentials](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/a88b4b72-b461-4b5e-b024-91da1cbe500f) |This control checks whether the project contains the environment variables <code>AWS_ACCESS_KEY_ID</code> and <code>AWS_SECRET_ACCESS_KEY</code>.<br>Authentication credentials <code>AWS_ACCESS_KEY_ID</code> and <code>AWS_SECRET_ACCESS_KEY</code> should never be stored in clear text, as this could lead to unintended data exposure and unauthorized access. |High |
|[DynamoDB Accelerator (DAX) clusters should be encrypted at rest](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/58e67d3d-8b17-4c1c-9bc4-550b10f0328a) |This control checks whether a DAX cluster is encrypted at rest. <br> Encrypting data at rest reduces the risk of data stored on disk being accessed by a user not authenticated to AWS. The encryption adds another set of access controls to limit the ability of unauthorized users to access to the data. <br> For example, API permissions are required to decrypt the data before it can be read. |Medium |
|[DynamoDB tables should automatically scale capacity with demand](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/47476790-2527-4bdb-b839-3b48ed18dccf) |This control checks whether an Amazon DynamoDB table can scale its read and write capacity as needed. This control passes if the table uses either on-demand capacity mode or provisioned mode with auto scaling configured. <br> Scaling capacity with demand avoids throttling exceptions, which helps to maintain availability of your applications. |Medium |
|[DynamoDB tables should automatically scale capacity with demand](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/03c0e8b8-fcb4-48d1-ae1a-d35e08748340) |This control checks whether an Amazon DynamoDB table can scale its read and write capacity as needed. This control passes if the table uses either on-demand capacity mode or provisioned mode with auto scaling configured. Scaling capacity with demand avoids throttling exceptions, which helps to maintain availability of your applications. |Medium |
|[EC2 instances managed by Systems Manager should have a patch compliance status of COMPLIANT after a patch installation](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/75c358f9-f644-41d1-9a07-af69f5ee0e2f) |This control checks whether the compliance status of the Amazon EC2 Systems Manager patch compliance is 'COMPLIANT' or 'NON_COMPLIANT' after the patch installation on the instance. It only checks instances that are managed by AWS Systems Manager Patch Manager. It does not check whether the patch was applied within the 30-day limit prescribed by PCI DSS requirement 6.2. It also does not validate whether the patches applied were classified as security patches. You should create patching groups with the appropriate baseline settings and ensure in-scope systems are managed by those patch groups in Systems Manager. |Medium |
|[EC2 instances managed by Systems Manager should have an association compliance status of COMPLIANT](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/32b4b856-848d-4ce2-bec7-1a9be69bce6a) |This control checks whether the status of the AWS Systems Manager association compliance is 'COMPLIANT' or 'NON_COMPLIANT' after the association is run on an instance. The control passes if the association compliance status is COMPLIANT. A State Manager association is a configuration that is assigned to your managed instances. The configuration defines the state that you want to maintain on your instances. For example, an association can specify that antivirus software must be installed and running on your instances, or that certain ports must be closed. After you create one or more State Manager associations, compliance status information is immediately available to you in the console or in response to AWS CLI commands or corresponding Systems Manager API operations. For associations, Configuration Compliance shows statuses of Compliant or Non-compliant and the severity level assigned to the association, such as Critical or Medium. You must configure your in-scope EC2 instances for Systems Manager association. You must also configure the patch baseline for the security rating of the vendor of patches, and set the autoapproval date to meet PCI DSS 3.2.1 requirement 6.2. |Low |
|[EC2 instances should be connected to Azure Arc](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/231dee23-84db-44d2-bd9d-c32fbcfb42a3) |Connect your EC2 instances to Azure Arc in order to have full visibility to Azure Defender for Servers security content. Learn more about <a href='/azure/azure-arc/servers/overview'>Azure Arc</a>, and about <a href='/azure/security-center/defender-for-servers-introduction'>Azure Defender for Servers</a> on hybrid-cloud environment. |High |
|[EC2 instances should be managed by AWS Systems Manager](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/4be5393d-cc33-4ef7-acae-80295bc3ae35) |Status of the Amazon EC2 Systems Manager patch compliance is 'COMPLIANT' or 'NON_COMPLIANT' after the patch installation on the instance. <br> Only  instances that are managed by AWS Systems Manager Patch Manager are checked. Patches that were applied within the 30-day limit prescribed by PCI DSS requirement '6' are not checked.  |Medium |
|[EC2 instances should be managed by AWS Systems Manager](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/6a9bbcb5-81a9-4164-8d17-03b255107dad) |This control checks whether the EC2 instances in your account are managed by Systems Manager. AWS Systems Manager is an AWS service that you can use to view and control your AWS infrastructure. To help you to maintain security and compliance, Systems Manager scans your managed instances. A managed instance is a machine that is configured for use with Systems Manager. Systems Manager then reports or takes corrective action on any policy violations that it detects. Systems Manager also helps you to configure and maintain your managed instances. Additional configuration is needed in Systems Manager for patch deployment to managed EC2 instances. |Medium |
|[Lambda functions should have a dead-letter queue configured](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/dcf10b98-798f-4734-9afd-800916bf1e65) |This control checks whether a Lambda function is configured with a dead-letter queue. The control fails if the Lambda function is not configured with a dead-letter queue.<br>As an alternative to an on-failure destination, you can configure your function with a dead-letter queue to save discarded events for further processing. <br> A dead-letter queue acts the same as an on-failure destination. It is used when an event fails all processing attempts or expires without being processed.<br>A dead-letter queue allows you to look back at errors or failed requests to your Lambda function to debug or identify unusual behavior.<br>From a security perspective, it is important to understand why your function failed and to ensure that your function does not drop data or compromise data security as a result. <br> For example, if your function cannot communicate to an underlying resource, that could be a symptom of a denial of service (DoS) attack elsewhere in the network. |Medium |
|[Lambda functions should use latest runtimes](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/ac49a0a5-db33-4be7-9738-301783b6bba9) |This control checks that the Lambda function settings for runtimes match the expected values set for the latest runtimes for each supported language. This control checks for the following runtimes: nodejs12.x, nodejs10.x, python3.8, python3.7, python3.6, ruby2.5, ruby2.7,java11, java8, go1.x, dotnetcore2.1, dotnetcore3.1 Lambda runtimes are built around a combination of operating system, programming language, and software libraries that are subject to maintenance and security updates. When a runtime component is no longer supported for security updates, Lambda deprecates the runtime. Even though you cannot create functions that use the deprecated runtime, the function is still available to process invocation events. Make sure that your Lambda functions are current and do not use out-of-date runtime environments. |Medium |
|[Lambda functions should use supported runtimes](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/e656e5b7-130c-4fb4-be90-9bdd4f82fdfb) |This control checks that the Lambda function settings for runtimes match the expected values set for the supported runtimes for each language. This control checks for the following runtimes: <br> <b>nodejs14.x</b>, <b>nodejs12.x</b>, <b>nodejs10.x</b>, <b>python3.8</b>, <b>python3.7</b>, <b>python3.6</b>, <b>ruby2.7</b>, <b>ruby2.5</b>, <b>java11</b>, <b>java8</b>, <b>java8.al2</b>, <b>go1.x</b>, <b>dotnetcore3.1</b>, <b>dotnetcore2.1</b><br><a href='https://docs.aws.amazon.com/lambda/latest/dg/lambda-runtimes.html'>Lambda runtimes</a> are built around a combination of operating system, programming language, and software libraries that are subject to maintenance and security updates. When a runtime component is no longer supported for security updates, Lambda deprecates the runtime. Even though you cannot create functions that use the deprecated runtime, the function is still available to process invocation events. Make sure that your Lambda functions are current and do not use out-of-date runtime environments.<br>To learn more about the supported runtimes that this control checks for the supported languages, see <a href='https://docs.aws.amazon.com/lambda/latest/dg/lambda-runtimes.html'>AWS Lambda runtimes</a> in the AWS Lambda Developer Guide. |Medium |
|[Management ports of EC2 instances should be protected with just-in-time network access control](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/9b26b102-ccde-4697-aa30-f0621f865f99) |Azure Security Center has identified some overly-permissive inbound rules for management ports in your network. Enable just-in-time access control to protect your Instances from internet-based brute-force attacks. <a href=\/azure/security-center/security-center-just-in-time\>Learn more.</a> |High |
|[SSM agent should be installed on your AWS EC2 instances](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/bc85a7ee-7f43-47ab-8736-4faaec9346b5) |Systems Manager is an AWS service that can be used to control and view your AWS infrastructure. The AWS Systems Manager Agent (SSM Agent) is a software that can be installed and configured on a machine and makes it possible for Systems Manager to update and configure these resources. Security Center leverages the SSM Agent for automatic installation of Azure Arc, that enables greater parity for AWS instances to Azure VMs. |Medium |
|[Unused EC2 security groups should be removed](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/86f26232-2132-4707-99ff-4e70ee16c3ab) |This control helps you maintain an accurate asset inventory of needed security groups in your cardholder data environment (CDE). It does so by checking that security groups are attached to Amazon EC2 instances or to an ENI. A failed finding indicates you may have unused Amazon EC2 security groups. |Low |
|[Unused EC2 security groups should be removed](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/f065cc7b-f63b-4865-b8ff-4a1292e1a5cb) |Security groups should be attached to Amazon EC2 instances or to an ENI. <br> healthy finding can indicate there are unused Amazon EC2 security groups. |Low |
|||
