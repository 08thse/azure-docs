---
author: memildin
ms.service: security-center
ms.topic: include
ms.date: 01/12/2021
ms.author: memildin
ms.custom: generated
---

|Recommendation |Description |Severity |
|---|---|---|
|A log metric filter and alarm should exist for usage of the "root" user |Checks the following metric filters : That the log group name is configured for use with  multi-region CloudTrail activated, that there is at least one Event Selector for a Trail with IncludeManagementEvents configured to true and ReadWriteType configured to All, and that there is at least one subscriber active to an SNS topic associated to the alarm.<br />(No related policy) |High |
|A maximum of 3 owners should be designated for your subscription |To reduce the potential for breaches by compromised owner accounts, we recommend limiting the number of owner accounts to a maximum of 3<br />(Related policy: [A maximum of 3 owners should be designated for your subscription](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f4f11b553-d42e-4e3a-89be-32ca364cad4c)) |High |
|Amazon Elasticsearch domains should be in a VPC |Checks if Amazon Elasticsearch Service domains are in a VPC.<br />(No related policy) |High |
|Amazon SageMaker notebook instances should not have direct internet access |Checks if direct internet access is disabled for an Amazon SageMaker notebook instance by checking the DirectInternetAccess field is set to disabled for an Amazon SageMaker notebook instance.<br />(No related policy) |High |
|Avoid the use of the "root" account |The "root" account is the most privileged account and has unrestricted access to all resources in the AWS account. It is highly recommended to avoid use of this account.<br />(No related policy) |High |
|AWS Config should be enabled |Checks if AWS Config is enabled for the current account and region. The AWS Config service manages configuration of supported AWS resources in your account and sends log files to you. Security Hub recommends AWS Config should be enabled in all regions.<br />(No related policy) |Medium |
|AWS Security Hub should be enabled for all AWS member accounts |AWS Security Hub provides you with a comprehensive view of your security state within AWS and your compliance with security standards and best practices. Integrating it into Security Center enables a comprehensive view across multiple cloud environments. any AWS member account related to an onboarded account should have Security Hub enabled as well.<br />(No related policy) |Medium |
|AWS Security Hub should be enabled in every region in your AWS accounts |AWS Security Hub is a regional service and customer must enable Security Hub in each region to view findings in that region. You should continuously monitor all regions across all of your AWS accounts for unauthorized behavior or misconfigurations, including regions you donâ€™t use heavily.<br />(No related policy) |Medium |
|Azure Defender for Key Vault should be enabled |Azure Security Center includes Azure Defender for Key Vault, providing an additional layer of security intelligence.<br>Azure Defender for Key Vault detects unusual and potentially harmful attempts to access or exploit Key Vault accounts.<br><br>Important: Remediating this recommendation will result in charges for protecting your key vaults. If you don't have any key vaults in this subscription, no charges will be incurred.<br>If you create any key vaults on this subscription in the future, they will automatically be protected and charges will begin at that time.<br> <a href='https://docs.microsoft.com/azure/security-center/advanced-threat-protection-key-vault'>Learn more about Azure Defender for Key Vault.</a><br />(Related policy: [Azure Defender for Key Vault should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fmicrosoft.authorization%2fpolicyDefinitions%2f0e6763cc-5078-4e64-889d-ff4d9a839047)) |High |
|CloudTrail should be enabled |Checks if AWS CloudTrail is enabled in your AWS account<br />(No related policy) |High |
|CloudTrail trails should be integrated with Amazon CloudWatch Logs |Checks if AWS CloudTrail trails are set to send logs to Amazon CloudWatch Logs<br />(No related policy) |Low |
|CodeBuild GitHub or Bitbucket source repository URLs should use OAuth |Checks if the GitHub or Bitbucket source repository URL includes personal access tokens or user name and password.<br />(No related policy) |High |
|CodeBuild project environment variables should not contain clear text credentials |Checks if a CodeBuild project includes environment variables AWS_ACCESS_KEY_ID and AWS_SECRET_ACCESS_KEY.<br />(No related policy) |High |
|Customer master key (CMK) rotation should be enabled |Checks if key rotation is enabled for each customer master key (CMK). It doesn't check CMKs that have imported key material.<br />(No related policy) |Medium |
|Deprecated accounts should be removed from your subscription |User accounts that have been blocked from signing in, should be removed from your subscriptions.<br>These accounts can be targets for attackers looking to find ways to access your data without being noticed.<br />(Related policy: [Deprecated accounts should be removed from your subscription](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f6b1cbf55-e8b6-442f-ba4c-7246b6381474)) |High |
|Deprecated accounts with owner permissions should be removed from your subscription |User accounts that have been blocked from signing in, should be removed from your subscriptions.<br>These accounts can be targets for attackers looking to find ways to access your data without being noticed.<br />(Related policy: [Deprecated accounts with owner permissions should be removed from your subscription](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2febb62a0c-3560-49e1-89ed-27e074e9f8ad)) |High |
|Diagnostic logs in Key Vault should be enabled |Enable logs and retain them up to a year. This enables you to recreate activity trails for investigation purposes when a security incident occurs or your network is compromised.<br />(Related policy: [Diagnostic logs in Key Vault should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2fcf820ca0-f99e-4f3e-84fb-66e913812d21)) |Low |
|Ensure a log metric filter and alarm exist for AWS Config configuration changes |By directing CloudTrail Logs to CloudWatch Logs real-time monitoring of API calls can be achieved. Metric filter and alarm should be established for changes to AWS Config configuration settings<br />(No related policy) |Medium |
|Ensure a log metric filter and alarm exist for AWS Management Console authentication failures |By directing CloudTrail Logs to CloudWatch Logs real-time monitoring of API calls can be achieved. Metric filter and alarm should be established for failed console authentication attempts.<br />(No related policy) |Medium |
|Ensure a log metric filter and alarm exist for AWS Management Console sign-in without MFA |By directing CloudTrail Logs to CloudWatch Logs real-time monitoring of API calls can be achieved. Metric filter and alarm should be established for console logins that are not protected by multi-factor authentication (MFA).<br />(No related policy) |Medium |
|Ensure a log metric filter and alarm exist for CloudTrail configuration changes |By directing CloudTrail Logs to CloudWatch Logs real-time monitoring of API calls can be achieved. Metric filter and alarm should be established for changes made to CloudTrail's configurations<br />(No related policy) |Medium |
|Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created CMKs |By directing CloudTrail Logs to CloudWatch Logs real-time monitoring of API calls can be achieved. Metric filter and alarm should be established for customer created CMKs which have changed state to disabled or scheduled deletion.<br />(No related policy) |Medium |
|Ensure a log metric filter and alarm exist for IAM policy changes |By directing CloudTrail Logs to CloudWatch Logs real-time monitoring of API calls can be achieved. Metric filter and alarm should be established for changes made to Identity and Access Management (IAM) policies<br />(No related policy) |Medium |
|Ensure a log metric filter and alarm exist for security group changes |By directing CloudTrail Logs to CloudWatch Logs real-time monitoring of API calls can be achieved. Metric filter and alarm should be established for changes to Security Groups.<br />(No related policy) |Medium |
|Ensure a log metric filter and alarm exist for unauthorized API calls |By directing CloudTrail Logs to CloudWatch Logs real-time monitoring of API calls can be achieved. Metric filter and alarm should be established for unauthorized API calls.<br />(No related policy) |Medium |
|Ensure a log metric filter and alarm exist for usage of "root" account |By directing CloudTrail Logs to CloudWatch Logs real-time monitoring of API calls can be achieved. Metric filter and alarm should be established for root account login attempts.<br />(No related policy) |Medium |
|Ensure a support role has been created to manage incidents with AWS Support |AWS provides a support center that can be used for incident notification and response, as well as technical support and customer services. IAM Role should be created to allow authorized users to manage incidents with AWS Support.<br />(No related policy) |Low |
|Ensure access keys are rotated every 90 days or less |Access keys consist of an access key ID and secret access key. they are used to sign programmatic requests made to AWS. Access keys should be regularly rotated to reduce chance of access key used that is associated with a compromised or terminated account and ensure that data can't be accessed with an old key that might have been lost, cracked, or stolen.<br />(No related policy) |Medium |
|Ensure API keys are not created for a project |Ensure that all API keys are not used within the scope of projects. The standard authentication flow should be implemented, since the use of API keys presents many security risks.<br />(No related policy) |Medium |
|Ensure API keys are restricted to only APIs that application needs |Ensure that API keys are restricted to only access API endpoints that are essential to the calling application.<br />(No related policy) |Medium |
|Ensure API keys are restricted to use by only specified Hosts and Apps |Ensure that API keys are restricted, and used only by trusted hosts, HTTP referrers, or applications.<br />(No related policy) |Medium |
|Ensure API keys are rotated every 90 days |Ensure that API keys are rotated every 90 days or less.<br />(No related policy) |Medium |
|Ensure AWS Config is enabled in all regions |AWS Config is a web service that performs configuration management of supported AWS resources within your account and delivers log files to you that can be used for security analysis, resource change tracking, and compliance auditing and should be enabled across all regions.<br />(No related policy) |Medium |
|Ensure CloudTrail is enabled in all regions |AWS CloudTrail is a web service that records AWS API calls for your account and delivers log files to you. CloudTrail should be enabled to allow security analysis, resource change tracking, and compliance auditing.<br />(No related policy) |High |
|Ensure CloudTrail log file validation is enabled |A digitally signed digest file is created by CloudTrail log file validation,  containing a hash of each log that CloudTrail writes to S3. These digest files can be used to determine whether a log file was changed, deleted, or unchanged after CloudTrail delivered the log.  <br />(No related policy) |Low |
|Ensure CloudTrail trails are integrated with Amazon CloudWatch Logs |AWS CloudTrail is a web service that records AWS API calls made in a given AWS account. In addition to capturing CloudTrail logs within a specified S3 bucket for long term analysis, sending these logs to CloudWatch should be done to enable realtime analysis. <br />(No related policy) |Low |
|Ensure credentials unused for 90 days or greater are disabled |AWS resources can be accessed by using different types of credentials by AWS IAm users. Credentials such as passwords or access keys that haven't been used in 90 days or more should be deactivated or removed.<br />(No related policy) |Medium |
|Ensure hardware MFA is enabled for the "root" account |MFA should be enabled for a root account to increase console security.  When a user signs in to an AWS website, they will be prompted for their user name, password as well as for an authentication code. The account should be protected with a hardware MFA<br />(No related policy) |High |
|Ensure IAM password policy expires passwords within 90 days or less |IAM password policies should require passwords to expire after 90 days or less.<br />(No related policy) |Low |
|Ensure IAM password policy prevents password reuse |IAM password policy should prevent the reuse of passwords to prevent reuse of given password by the same user.<br />(No related policy) |Low |
|Ensure IAM password policy requires at least one lowercase letter |Password policy should require at least one lowercase letter to enforce password complexity requirements . <br />(No related policy) |Medium |
|Ensure IAM password policy requires at least one number |Password policy should require at least one number to enforce password complexity requirements . <br />(No related policy) |Medium |
|Ensure IAM password policy requires at least one symbol |Password policy should require at least one symbol to enforce password complexity requirements . <br />(No related policy) |Medium |
|Ensure IAM password policy requires at least one uppercase letter |Password policy should require at least one uppercase letter to enforce password complexity requirements . <br />(No related policy) |Medium |
|Ensure IAM password policy requires minimum password length of 14 or greater |Password policy should require a length of 14 or greater to enforce password complexity requirements.<br />(No related policy) |Medium |
|Ensure IAM policies are attached only to groups or roles |By default, IAM users, groups, and roles don't have access to AWS resources. IAM policies are used to grant privileges to users, groups, or roles. IAM policies should be applied directly to groups and roles but not users<br />(No related policy) |Low |
|Ensure IAM policies that allow full "*:*" administrative privileges are not created |IAM policies are the way in  which privileges are granted to users, groups, or roles. Granting only the permissions needed to perform a task should be done instead of allowing full administrative privileges.<br />(No related policy) |High |
|Ensure KMS encryption keys are rotated within a period of 90 days |Ensure that Cloud KMS encryption keys are rotated every 90 days or less.<br />(No related policy) |Medium |
|Ensure log metric filter and alerts exist for project ownership assignments/changes |Ensure log metric filters and alerts are configured to monitor project ownership assignment/change actions.<br />(No related policy) |Low |
|Ensure MFA is enabled for the "root" account |MFA should be enabled for a root account to increase console security.  When a user signs in to an AWS website, they will be prompted for their user name, password as well as for an authentication code<br />(No related policy) |High |
|Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password |Multi-Factor Authentication (MFA) should be enabled on all accounts that have a console password.<br />(No related policy) |Medium |
|Ensure no root account access key exists |The root account is the most privileged user in an AWS account. AWS Access Keys provide programmatic access to an AWS account.  All access keys associated with the root account should be removed.<br />(No related policy) |High |
|Ensure oslogin is enabled for a Project |Ensure that OS login is enabled for all projects, as this pairs the SSH keys in use with IAM users. <br />(No related policy) |Medium |
|Ensure rotation for customer created CMKs is enabled |AWS Key Management Service (KMS) enables customers to rotate the backing key, a key material stored within the KMS which is tied to the key ID of the Customer Created customer master key (CMK). The backing key is used to perform cryptographic operations such as encryption and decryption.<br />(No related policy) |High |
|Ensure that Cloud Audit Logging is configured properly across all services and all users from a project |Ensure that Cloud Audit Logging is configured to track read and write activities across all supported services and for all users. Configured this way, all administrative activities, or attempts to access user data, will be tracked.<br />(No related policy) |Medium |
|Ensure that corporate login credentials are used |Make sure to log in using the credentials of a fully-managed corporate account and not a personal account.<br />(No related policy) |High |
|Ensure that IAM users are not assigned the Service Account User or Service Account Token Creator roles at project level |Ensure that the 'Service Account User' and 'Service Account Token Creator' roles are not granted to users at a project level. Instead, grant these roles to users in the context of specific service accounts.<br />(No related policy) |Medium |
|Ensure that multi-factor authentication is enabled for all non-service accounts |Multi-Factor Authentication (MFA) must be enabled for all Google Cloud Platform accounts, excluding service accounts.<br />(No related policy) |High |
|Ensure that Separation of duties is enforced while assigning service account related roles to users |Ensure that there is a separation of duties. Also, make sure that users are not assigned with both 'Service Account Admin' and other 'Service Account User' roles.<br />(No related policy) |Medium |
|Ensure that Service Account has no Admin privileges |Ensure that all service accounts are not configured with administrative roles.<br />(No related policy) |Medium |
|Ensure that sinks are configured for all log entries |Ensure that all resource have a log sink configured, exporting copies of all the log entries to a centralized location such as a SIEM.<br />(No related policy) |Low |
|Ensure that the log metric filter and alerts exist for Audit Configuration changes |Ensure log metric filter and alerts are configured for Audit Configuration changes. Audit logging data is required for security analysis. Tracking the log metric filters and alerts is important to ensure that all activities in the projects are being audited as planned.<br />(No related policy) |Low |
|Ensure that the log metric filter and alerts exist for Custom Role changes |Ensure that log metric filter and alerts are configured for Custom Role changes. Monitoring role creation, update, or deletion may help to identify over-privileged or misused roles. <br />(No related policy) |Low |
|Ensure user-managed/external keys for service accounts are rotated every 90 days or less |Ensure that all service account keys are rotated every 90 days or less.<br />(No related policy) |Medium |
|External accounts with owner permissions should be removed from your subscription |Accounts with owner permissions that have different domain names (external accounts), should be removed from your subscription. This prevents unmonitored access. These accounts can be targets for attackers looking to find ways to access your data without being noticed.<br />(Related policy: [External accounts with owner permissions should be removed from your subscription](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2ff8456c1c-aa66-4dfb-861a-25d127b775c9)) |High |
|External accounts with read permissions should be removed from your subscription |Accounts with read permissions that have different domain names (external accounts), should be removed from your subscription. This prevents unmonitored access. These accounts can be targets for attackers looking to find ways to access your data without being noticed.<br />(Related policy: [External accounts with read permissions should be removed from your subscription](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f5f76cf89-fbf2-47fd-a3f4-b891fa780b60)) |High |
|External accounts with write permissions should be removed from your subscription |Accounts with write permissions that have different domain names (external accounts), should be removed from your subscription. This prevents unmonitored access. These accounts can be targets for attackers looking to find ways to access your data without being noticed.<br />(Related policy: [External accounts with write permissions should be removed from your subscription](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f5c607a2e-c700-4744-8254-d77e7c9eb5e4)) |High |
|GuardDuty should be enabled |Checks if Amazon GuardDuty is enabled in your AWS account and region. Amazon GuardDuty is a continuous security monitoring service that can identify unexpected and potentially unauthorized and malicious activity within your AWS environment <br />(No related policy) |Medium |
|Hardware MFA should be enabled for the root user |Checks whether your AWS account is enabled to use multi-factor authentication (MFA) hardware device to sign in with root credentials. MFA adds a layer of protection on top of a user name and password for accessing cardholder data environment. <br />(No related policy) |High |
|IAM policies should not allow full "*" administrative privileges |Checks if the AWS Identity and Access Management (IAM) policies default version (also known as customer managed policies) do not have administrator access with a statement that has "Effect": "Allow" with "Action": "*" over "Resource": "*". It does not check inline and AWS Managed Policies, only for the Customer Managed Policies that you created.<br />(No related policy) |High |
|IAM root user access key should not exist |Checks if the root user access key is available.<br />(No related policy) |High |
|IAM user credentials should be disabled if not used within a pre-defined number days |Checks if your AWS Identity and Access Management (IAM) users have inactive credentials that have not been used within a specified number of days, default is 90 days.<br />(No related policy) |Medium |
|IAM users should not have IAM policies attached |Checks that none of your IAM users have attached policies, they must inherit permissions from IAM groups or roles.<br />(No related policy) |Low |
|Lambda functions should prohibit public access |Checks if the Lambda resource has a Lambda function policy attached that prohibits public access<br />(No related policy) |High |
|MFA should be enabled for all IAM users |Checks if the AWS Identity and Access Management users have multi-factor authentication (MFA) enabled<br />(No related policy) |Medium |
|MFA should be enabled on accounts with owner permissions on your subscription |Multi-Factor Authentication (MFA) should be enabled for all subscription accounts with owner permissions to prevent a breach of accounts or resources.<br />(Related policy: [MFA should be enabled on accounts with owner permissions on your subscription](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2faa633080-8b72-40c4-a2d7-d00c03e80bed)) |High |
|MFA should be enabled on accounts with read permissions on your subscription |Multi-Factor Authentication (MFA) should be enabled for all subscription accounts with read privileges to prevent a breach of accounts or resources.<br />(Related policy: [MFA should be enabled on accounts with read permissions on your subscription](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2fe3576e28-8b17-4677-84c3-db2990658d64)) |High |
|MFA should be enabled on accounts with write permissions on your subscription |Multi-Factor Authentication (MFA) should be enabled for all subscription accounts with write privileges to prevent a breach of accounts or resources.<br />(Related policy: [MFA should be enabled accounts with write permissions on your subscription](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f9297c21d-2ed6-4474-b48f-163f75654ce3)) |High |
|Password policies for IAM users should have strong configurations |Checks if the account password policy for IAM users uses the following configurations: Require at least one uppercase character in password  (Default = true), Require at least one lowercase character in password (Default = true), Require at least one number in password (Default = true), Password minimum length (Default = 7 or longer), Number of passwords before allowing reuse (Default = 4), Number of days before password expiration (Default = 90).<br />(No related policy) |Medium |
|S3 Block Public Access setting should be enabled |S3 buckets should block public access, this checks if the following public access block settings are configured from an account level: ignorePublicAcls: True, blockPublicPolicy: True, blockPublicAcls: True, restrictPublicBuckets: True.<br />(No related policy) |Medium |
|S3 buckets should prohibit public read access |Checks whether your S3 buckets enable public read access by checking the bucket policy, the Block Public Access settings, and the bucket access control list (ACL).Make sure that access to the bucket is restricted to authorized principals only.<br />(No related policy) |High |
|S3 buckets should prohibit public write access |Checks whether your S3 buckets enable public write access by checking the bucket policy, the Block Public Access settings, and the bucket access control list (ACL). Make sure that access to the bucket is restricted to authorized principals only.<br />(No related policy) |High |
|Service principals should be used to protect your subscriptions instead of Management Certificates |Management certificates allow anyone who authenticates with them to manage the subscription(s) they are associated with. To manage subscriptions more securely, using service principals with Resource Manager is recommended to limit the blast radius in the case of a certificate compromise. It also automates resource management. <br />(Related policy: [Service principals should be used to protect your subscriptions instead of management certificates](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f6646a0bd-e110-40ca-bb97-84fcee63c414)) |Medium |
|Storage account public access should be disallowed |Anonymous public read access to containers and blobs in Azure Storage is a convenient way to share data, but might present security risks. To prevent data breaches caused by undesired anonymous access, Microsoft recommends preventing public access to a storage account unless your scenario requires it.<br />(Related policy: [Storage account public access should be disallowed](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fmicrosoft.authorization%2fpolicyDefinitions%2f4fa4b6c0-31ca-4c0d-b10d-24b96f62a751)) |Medium |
|There should be more than one owner assigned to your subscription |Designate more than one subscription owner in order to have administrator access redundancy.<br />(Related policy: [There should be more than one owner assigned to your subscription](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f09024ccc-0c5f-475e-9457-b7c0d9ed487b)) |High |
|Validity period of certificates stored in Azure Key Vault should not exceed 12 months |Ensure your certificates do not have a validity period that exceeds 12 months.<br />(Related policy: [Certificates should have the specified maximum validity period](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f0a075868-4c26-42ef-914c-5bc007359560)) |Medium |
|Virtual MFA should be enabled for the root user |Checks if users of your AWS account require a multi-factor authentication (MFA) device to sign in with root credentials.<br />(No related policy) |High |
